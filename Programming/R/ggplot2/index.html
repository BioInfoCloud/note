
<!doctype html>
<html lang="zh" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="生物信息云">
      
      
        <meta name="author" content="DoubleHelix">
      
      
        <link rel="canonical" href="https://bioinfocloud.io/Programming/R/ggplot2/">
      
      
        <link rel="prev" href="../../../BioInfo/RNAseq/hisat2/">
      
      
        <link rel="next" href="../../../visualization/visualizationList/">
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.22">
    
    
      
        <title>可视化 - 生物信息云</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.84d31ad4.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../mkdocs/css/no-footer.css">
    
      <link rel="stylesheet" href="../../../mkdocs/css/unordered-list-symbols.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="light-blue">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#r" class="md-skip">
          跳转至
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="页眉">
    <a href="../../.." title="生物信息云" class="md-header__button md-logo" aria-label="生物信息云" data-md-component="logo">
      
  <img src="../../../assets/logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            生物信息云
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              可视化
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="light-blue"  aria-label="切换风格"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="切换风格" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.04 8.71V4h-4.7L12 .69 8.71 4H4v4.71L.69 12 4 15.34v4.7h4.71L12 23.35l3.34-3.31h4.7v-4.7L23.35 12zM8.83 7.05c.98 0 1.77.79 1.77 1.78a1.77 1.77 0 0 1-1.77 1.77c-.99 0-1.78-.79-1.78-1.77 0-.99.79-1.78 1.78-1.78M15.22 17c-.98 0-1.77-.8-1.77-1.78a1.77 1.77 0 0 1 1.77-1.77c.98 0 1.78.79 1.78 1.77A1.78 1.78 0 0 1 15.22 17m-6.72.03L7 15.53 15.53 7l1.5 1.5z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="orange"  aria-label="切换风格"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="切换风格" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="deep-purple"  aria-label="切换风格"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="切换风格" for="__palette_3" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="purple" data-md-color-primary="black" data-md-color-accent="pink"  aria-label="切换风格"  type="radio" name="__palette" id="__palette_3">
    
      <label class="md-header__button md-icon" title="切换风格" for="__palette_4" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="light-green" data-md-color-primary="black" data-md-color-accent="light-blue"  aria-label="切换至日间模式"  type="radio" name="__palette" id="__palette_4">
    
      <label class="md-header__button md-icon" title="切换至日间模式" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9 2c-1.05 0-2.05.16-3 .46 4.06 1.27 7 5.04 7 9.54s-2.94 8.27-7 9.54c.95.3 1.95.46 3 .46a10 10 0 0 0 10-10A10 10 0 0 0 9 2"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="搜索" placeholder="搜索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="查找">
        
        <button type="reset" class="md-search__icon md-icon" title="清空当前内容" aria-label="清空当前内容" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            正在初始化搜索引擎
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://bioinfocloud.github.io/note" title="前往仓库" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    BioInfoCloud
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="标签" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../" class="md-tabs__link">
          
  
  
    
  
  生信编程

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../BioInfo/" class="md-tabs__link">
          
  
  
    
  
  生信基础

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="./" class="md-tabs__link">
          
  
  
    
  
  可视化

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../bigdata/" class="md-tabs__link">
          
  
  
    
  
  大数据

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../ML/knn/kNN/" class="md-tabs__link">
          
  
  
    
  
  机器学习

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../BioInfo/scRNAseq/scRNASeq_UP/" class="md-tabs__link">
          
  
  
    
  
  专题

        </a>
      </li>
    
  

    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../Literature/RNAseq_review1/" class="md-tabs__link">
          
  
  
    
  
  文献

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../BioInfo/database/scList/" class="md-tabs__link">
          
  
  
    
  
  数据库工具

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../WeChatOfficialAccount/HOME/" class="md-tabs__link">
          
  
  
    
  
  微信

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../ABOUT/" class="md-tabs__link">
          
  
  
    
  
  关于

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="导航栏" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="生物信息云" class="md-nav__button md-logo" aria-label="生物信息云" data-md-component="logo">
      
  <img src="../../../assets/logo.png" alt="logo">

    </a>
    生物信息云
  </label>
  
    <div class="md-nav__source">
      <a href="https://bioinfocloud.github.io/note" title="前往仓库" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    BioInfoCloud
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_1" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    生信编程
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_1" id="__nav_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            生信编程
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_1_2" >
        
          
          <label class="md-nav__link" for="__nav_1_2" id="__nav_1_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Linux
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_2">
            <span class="md-nav__icon md-icon"></span>
            Linux
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Linux/linux/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Linux讲座
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Linux/commands-concise/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    命令行入门精简版
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Linux/vim/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    vim
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Linux/tmux/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    tmux
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Linux/unix/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    UNIX
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Linux/kernel-compile/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    内核编译
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_1_3" >
        
          
          <label class="md-nav__link" for="__nav_1_3" id="__nav_1_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Markdown
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_3">
            <span class="md-nav__icon md-icon"></span>
            Markdown
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Markdown/markdown/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Markdown讲座
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../vscode-python/vscode-python/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    VSCode及插件安装
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Markdown/grammars/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Markdown语法
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_1_4" >
        
          
          <label class="md-nav__link" for="__nav_1_4" id="__nav_1_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Git
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_4">
            <span class="md-nav__icon md-icon"></span>
            Git
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Git/git/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Git
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Git/git-demos/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Git例子
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Git/git-teamwork/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Git合作
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Git/windows-install/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Windows安装Git
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_1_5" >
        
          
          <label class="md-nav__link" for="__nav_1_5" id="__nav_1_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    R
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_5">
            <span class="md-nav__icon md-icon"></span>
            R
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Grammar/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    R语法
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    可视化
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    可视化
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#r" class="md-nav__link">
    <span class="md-ellipsis">
      一.R绘图系统
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1base" class="md-nav__link">
    <span class="md-ellipsis">
      1.base系统
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2grid" class="md-nav__link">
    <span class="md-ellipsis">
      2.grid系统
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3lattice" class="md-nav__link">
    <span class="md-ellipsis">
      3.lattice系统
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4ggplot2" class="md-nav__link">
    <span class="md-ellipsis">
      4.ggplot2系统
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5" class="md-nav__link">
    <span class="md-ellipsis">
      5.常见的绘图参数
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ggplot2" class="md-nav__link">
    <span class="md-ellipsis">
      二.ggplot2绘图框架
    </span>
  </a>
  
    <nav class="md-nav" aria-label="二.ggplot2绘图框架">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1geom_stat_" class="md-nav__link">
    <span class="md-ellipsis">
      1.geom_()与stat_()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2" class="md-nav__link">
    <span class="md-ellipsis">
      2.视觉通道
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3" class="md-nav__link">
    <span class="md-ellipsis">
      3.度量调整
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4" class="md-nav__link">
    <span class="md-ellipsis">
      4.坐标系
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5_1" class="md-nav__link">
    <span class="md-ellipsis">
      5.图例
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6" class="md-nav__link">
    <span class="md-ellipsis">
      6.分面系统
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#7" class="md-nav__link">
    <span class="md-ellipsis">
      7.主题
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#8" class="md-nav__link">
    <span class="md-ellipsis">
      8.位置调整
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#9" class="md-nav__link">
    <span class="md-ellipsis">
      9.学术文章图标配色
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#10" class="md-nav__link">
    <span class="md-ellipsis">
      10.排版布局
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    <span class="md-ellipsis">
      三.散点图
    </span>
  </a>
  
    <nav class="md-nav" aria-label="三.散点图">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1plot" class="md-nav__link">
    <span class="md-ellipsis">
      1.利用plot()绘制散点图
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2ggplot2" class="md-nav__link">
    <span class="md-ellipsis">
      2.ggplot2()绘制散点图
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      四.柱状图
    </span>
  </a>
  
    <nav class="md-nav" aria-label="四.柱状图">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#01" class="md-nav__link">
    <span class="md-ellipsis">
      01.单数据系列柱形图
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#02" class="md-nav__link">
    <span class="md-ellipsis">
      02.双数据系列柱形图
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#03" class="md-nav__link">
    <span class="md-ellipsis">
      03.堆积柱形图
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#04" class="md-nav__link">
    <span class="md-ellipsis">
      04.百分比堆积柱形图
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#05" class="md-nav__link">
    <span class="md-ellipsis">
      05.不等宽柱形图
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#06" class="md-nav__link">
    <span class="md-ellipsis">
      06.棒棒糖图
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#07" class="md-nav__link">
    <span class="md-ellipsis">
      07.克里兰夫点图
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#08dumbbellplot" class="md-nav__link">
    <span class="md-ellipsis">
      08.哑铃图（DumbbellPlot）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#09" class="md-nav__link">
    <span class="md-ellipsis">
      09.坡度图
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#10_1" class="md-nav__link">
    <span class="md-ellipsis">
      10.南丁格尔玫瑰图
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#11" class="md-nav__link">
    <span class="md-ellipsis">
      11.径向柱形图
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#12" class="md-nav__link">
    <span class="md-ellipsis">
      12.词云图
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    <span class="md-ellipsis">
      五.箱型图
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    <span class="md-ellipsis">
      六.热图绘制
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    <span class="md-ellipsis">
      七.生存曲线
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    <span class="md-ellipsis">
      八.火山图
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_1_5_3" >
        
          
          <label class="md-nav__link" for="__nav_1_5_3" id="__nav_1_5_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    R包开发
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_1_5_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_5_3">
            <span class="md-nav__icon md-icon"></span>
            R包开发
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../01-software/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    软件安装
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../02-DevelopmentManual/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    快速手册
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../shiny/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Shiny
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_1_6" >
        
          
          <label class="md-nav__link" for="__nav_1_6" id="__nav_1_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Python
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_6">
            <span class="md-nav__icon md-icon"></span>
            Python
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../python/links/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    语法基础
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../python/numpy/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Numpy
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../python/pandas/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Pandas
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../python/Matplotlib_visualization/Matplotlib_visualization/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Matplotlib
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../BioInfo/Biopython/01_install/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Biopython
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../BioInfo/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    生信基础
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2" id="__nav_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            生信基础
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    生信基础
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            生信基础
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../BioInfo/BioInfoBasics/Introduction/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    生信引言
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../BioInfo/BioInfoBasics/01/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    基础应用
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../BioInfo/BioInfoBasics/02_noun/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    生信名词
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../BioInfo/BioInfoBasics/03_sequence/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    测序技术原理
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../BioInfo/BioInfoBasics/04_format/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    数据文件格式
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../BioInfo/BioInfoBasics/biomaRt/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    biomaRt包
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../BioInfo/BioInfoBasics/counts_RPM_RPKM_FPKM_1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    RNASeq表达定量
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../BioInfo/BioInfoBasics/counts_RPM_RPKM_FPKM_2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    RNASeq表达定量转换
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../BioInfo/BioInfoBasics/DESeq2_edgeR_limma/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    RNASeq差异表达分析原理
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../BioInfo/BioInfoBasics/GO/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    什么是GO
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../BioInfo/BioInfoBasics/KEGG_GO_GSEA_what/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    富集分析理论基础
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../BioInfo/BioInfoBasics/hsa2mus/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    人鼠基因比较
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../BioInfo/BioInfoBasics/hsa2mus_2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    同源基因转换
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../BioInfo/BioInfoBasics/IDtrans/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    各种ID转换
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../BioInfo/BioInfoBasics/miRNA_ID/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    miRNA的ID转换
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_3" >
        
          
          <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    软件使用问题
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            软件使用问题
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../BioInfo/RNAseq/hisat2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Hisat2
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    可视化
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            可视化
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    可视化
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    可视化
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#r" class="md-nav__link">
    <span class="md-ellipsis">
      一.R绘图系统
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1base" class="md-nav__link">
    <span class="md-ellipsis">
      1.base系统
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2grid" class="md-nav__link">
    <span class="md-ellipsis">
      2.grid系统
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3lattice" class="md-nav__link">
    <span class="md-ellipsis">
      3.lattice系统
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4ggplot2" class="md-nav__link">
    <span class="md-ellipsis">
      4.ggplot2系统
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5" class="md-nav__link">
    <span class="md-ellipsis">
      5.常见的绘图参数
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ggplot2" class="md-nav__link">
    <span class="md-ellipsis">
      二.ggplot2绘图框架
    </span>
  </a>
  
    <nav class="md-nav" aria-label="二.ggplot2绘图框架">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1geom_stat_" class="md-nav__link">
    <span class="md-ellipsis">
      1.geom_()与stat_()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2" class="md-nav__link">
    <span class="md-ellipsis">
      2.视觉通道
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3" class="md-nav__link">
    <span class="md-ellipsis">
      3.度量调整
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4" class="md-nav__link">
    <span class="md-ellipsis">
      4.坐标系
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5_1" class="md-nav__link">
    <span class="md-ellipsis">
      5.图例
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6" class="md-nav__link">
    <span class="md-ellipsis">
      6.分面系统
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#7" class="md-nav__link">
    <span class="md-ellipsis">
      7.主题
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#8" class="md-nav__link">
    <span class="md-ellipsis">
      8.位置调整
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#9" class="md-nav__link">
    <span class="md-ellipsis">
      9.学术文章图标配色
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#10" class="md-nav__link">
    <span class="md-ellipsis">
      10.排版布局
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    <span class="md-ellipsis">
      三.散点图
    </span>
  </a>
  
    <nav class="md-nav" aria-label="三.散点图">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1plot" class="md-nav__link">
    <span class="md-ellipsis">
      1.利用plot()绘制散点图
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2ggplot2" class="md-nav__link">
    <span class="md-ellipsis">
      2.ggplot2()绘制散点图
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      四.柱状图
    </span>
  </a>
  
    <nav class="md-nav" aria-label="四.柱状图">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#01" class="md-nav__link">
    <span class="md-ellipsis">
      01.单数据系列柱形图
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#02" class="md-nav__link">
    <span class="md-ellipsis">
      02.双数据系列柱形图
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#03" class="md-nav__link">
    <span class="md-ellipsis">
      03.堆积柱形图
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#04" class="md-nav__link">
    <span class="md-ellipsis">
      04.百分比堆积柱形图
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#05" class="md-nav__link">
    <span class="md-ellipsis">
      05.不等宽柱形图
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#06" class="md-nav__link">
    <span class="md-ellipsis">
      06.棒棒糖图
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#07" class="md-nav__link">
    <span class="md-ellipsis">
      07.克里兰夫点图
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#08dumbbellplot" class="md-nav__link">
    <span class="md-ellipsis">
      08.哑铃图（DumbbellPlot）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#09" class="md-nav__link">
    <span class="md-ellipsis">
      09.坡度图
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#10_1" class="md-nav__link">
    <span class="md-ellipsis">
      10.南丁格尔玫瑰图
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#11" class="md-nav__link">
    <span class="md-ellipsis">
      11.径向柱形图
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#12" class="md-nav__link">
    <span class="md-ellipsis">
      12.词云图
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    <span class="md-ellipsis">
      五.箱型图
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    <span class="md-ellipsis">
      六.热图绘制
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    <span class="md-ellipsis">
      七.生存曲线
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    <span class="md-ellipsis">
      八.火山图
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../visualization/visualizationList/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    公众号文章参考
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../visualization/ScatterPlot/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    散点图
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../visualization/mult_volcano/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    多重火山图
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../visualization/colorScheme01/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    配色方案1
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../bigdata/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    大数据
    
  </span>
  

            </a>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            大数据
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    机器学习
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            机器学习
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../ML/knn/kNN/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    1.kNN算法理论
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../ML/knn/knn_py/knn_py/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    2.kNN实践案例
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    专题
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            专题
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_6_1" >
        
          
          <label class="md-nav__link" for="__nav_6_1" id="__nav_6_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    单细胞专题
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_1">
            <span class="md-nav__icon md-icon"></span>
            单细胞专题
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../BioInfo/scRNAseq/scRNASeq_UP/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    单细胞上游分析
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../BioInfo/scRNAseq/SeuratObj/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    了解Seurat对象
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../BioInfo/scRNAseq/scRNASeq_down/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    单细胞下游分析
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../BioInfo/scRNAseq/GSE130001/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    常规分析案例一
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../BioInfo/scRNAseq/SingleR/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    细胞注释-SingleR
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../BioInfo/scRNAseq/Scissor/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    表型关联分析
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../BioInfo/scRNAseq/CellChat/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    cellChat
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../BioInfo/scRNAseq/scMetabolism/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    scMetabolism
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../BioInfo/database/scList/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    单细胞相关数据库
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_6_2" >
        
          
          <label class="md-nav__link" for="__nav_6_2" id="__nav_6_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    RNAseq专题
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_2">
            <span class="md-nav__icon md-icon"></span>
            RNAseq专题
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../BioInfo/RNAseq/pipeline_1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Bulk RNAseq上游分析
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_6_3" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../BioInfo/TCGA/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    TCGA-GEO专题
    
  </span>
  

            </a>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_3">
            <span class="md-nav__icon md-icon"></span>
            TCGA-GEO专题
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_6_4" >
        
          
          <label class="md-nav__link" for="__nav_6_4" id="__nav_6_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    药物分析
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_4">
            <span class="md-nav__icon md-icon"></span>
            药物分析
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../BioInfo/drugAna/cellminer/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    CellMiner数据库
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../BioInfo/drugAna/ADMET/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ADMET计算
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_6_5" >
        
          
          <label class="md-nav__link" for="__nav_6_5" id="__nav_6_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    免疫浸润
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_5">
            <span class="md-nav__icon md-icon"></span>
            免疫浸润
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../BioInfo/immune/EaSIeR/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    EaSIeR
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_6_6" >
        
          
          <label class="md-nav__link" for="__nav_6_6" id="__nav_6_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    数据库工具
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_6">
            <span class="md-nav__icon md-icon"></span>
            数据库工具
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../BioInfo/database/CoMutDB/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    CoMutDB数据库
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../BioInfo/database/CysModDB/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    CysModDB数据库
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    文献
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            文献
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Literature/RNAseq_review1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    RNASeq综述
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Literature/Review/001_immunoediting/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    癌症免疫编辑
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Literature/Review/003_2021_immunotherapy/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    癌症免疫治疗
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Literature/Review/002_DTIS/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    药物靶点预测
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Literature/Review/004_2021_ICB/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ICB治疗
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Literature/scRNAseq/2023_NC_HNSCC/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    2023_HNSCC
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Literature/Review/006_Nano/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    纳米材料
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Literature/AI/001_AI/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    人工智能
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_8" >
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    数据库工具
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            数据库工具
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../BioInfo/database/scList/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    单细胞相关数据库
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../BioInfo/database/database/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    在线数据库
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../BioInfo/toolsandsoftware/tands/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    工具或软件
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_8_4" >
        
          
          <label class="md-nav__link" for="__nav_8_4" id="__nav_8_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    MedBioInfoCloud包
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_8_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8_4">
            <span class="md-nav__icon md-icon"></span>
            MedBioInfoCloud包
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../package/MedBioInfoCloud/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    安装
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../package/baseFun/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    基础函数
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../package/BulkRNA-Seq/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Bulk RNA-Seq
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../package/enrichAnalysis/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    富集分析
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../package/TCGA/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    TCGA数据挖掘
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_9" >
        
          
          <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    微信
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            微信
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../WeChatOfficialAccount/HOME/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    HOME
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../WeChatOfficialAccount/articleIndex/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    文章索引
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_10" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../ABOUT/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    关于
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_10" id="__nav_10_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10">
            <span class="md-nav__icon md-icon"></span>
            关于
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../ABOUT/announcement/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    工具
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../ABOUT/studentsGroup/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    微信群
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#r" class="md-nav__link">
    <span class="md-ellipsis">
      一.R绘图系统
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1base" class="md-nav__link">
    <span class="md-ellipsis">
      1.base系统
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2grid" class="md-nav__link">
    <span class="md-ellipsis">
      2.grid系统
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3lattice" class="md-nav__link">
    <span class="md-ellipsis">
      3.lattice系统
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4ggplot2" class="md-nav__link">
    <span class="md-ellipsis">
      4.ggplot2系统
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5" class="md-nav__link">
    <span class="md-ellipsis">
      5.常见的绘图参数
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ggplot2" class="md-nav__link">
    <span class="md-ellipsis">
      二.ggplot2绘图框架
    </span>
  </a>
  
    <nav class="md-nav" aria-label="二.ggplot2绘图框架">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1geom_stat_" class="md-nav__link">
    <span class="md-ellipsis">
      1.geom_()与stat_()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2" class="md-nav__link">
    <span class="md-ellipsis">
      2.视觉通道
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3" class="md-nav__link">
    <span class="md-ellipsis">
      3.度量调整
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4" class="md-nav__link">
    <span class="md-ellipsis">
      4.坐标系
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5_1" class="md-nav__link">
    <span class="md-ellipsis">
      5.图例
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6" class="md-nav__link">
    <span class="md-ellipsis">
      6.分面系统
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#7" class="md-nav__link">
    <span class="md-ellipsis">
      7.主题
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#8" class="md-nav__link">
    <span class="md-ellipsis">
      8.位置调整
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#9" class="md-nav__link">
    <span class="md-ellipsis">
      9.学术文章图标配色
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#10" class="md-nav__link">
    <span class="md-ellipsis">
      10.排版布局
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    <span class="md-ellipsis">
      三.散点图
    </span>
  </a>
  
    <nav class="md-nav" aria-label="三.散点图">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1plot" class="md-nav__link">
    <span class="md-ellipsis">
      1.利用plot()绘制散点图
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2ggplot2" class="md-nav__link">
    <span class="md-ellipsis">
      2.ggplot2()绘制散点图
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      四.柱状图
    </span>
  </a>
  
    <nav class="md-nav" aria-label="四.柱状图">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#01" class="md-nav__link">
    <span class="md-ellipsis">
      01.单数据系列柱形图
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#02" class="md-nav__link">
    <span class="md-ellipsis">
      02.双数据系列柱形图
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#03" class="md-nav__link">
    <span class="md-ellipsis">
      03.堆积柱形图
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#04" class="md-nav__link">
    <span class="md-ellipsis">
      04.百分比堆积柱形图
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#05" class="md-nav__link">
    <span class="md-ellipsis">
      05.不等宽柱形图
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#06" class="md-nav__link">
    <span class="md-ellipsis">
      06.棒棒糖图
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#07" class="md-nav__link">
    <span class="md-ellipsis">
      07.克里兰夫点图
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#08dumbbellplot" class="md-nav__link">
    <span class="md-ellipsis">
      08.哑铃图（DumbbellPlot）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#09" class="md-nav__link">
    <span class="md-ellipsis">
      09.坡度图
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#10_1" class="md-nav__link">
    <span class="md-ellipsis">
      10.南丁格尔玫瑰图
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#11" class="md-nav__link">
    <span class="md-ellipsis">
      11.径向柱形图
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#12" class="md-nav__link">
    <span class="md-ellipsis">
      12.词云图
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    <span class="md-ellipsis">
      五.箱型图
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    <span class="md-ellipsis">
      六.热图绘制
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    <span class="md-ellipsis">
      七.生存曲线
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    <span class="md-ellipsis">
      八.火山图
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h2 id="r">一.R绘图系统<a class="headerlink" href="#r" title="Permanent link">&para;</a></h2>
<p>在 R 里，主要有两大底层图形系统，一是 base 图形系统，二是 grid 图形系统。 lattice 包与 ggplot2包正是基于 grid 图形系统构建的，它们都有自己独特的图形语法。 
<div class="highlight"><pre><span></span><code>install.packages(&quot;shiny&quot;)
install.packages(&quot;ggsci&quot;)
install.packages(&quot;esquisse&quot;)
</code></pre></div></p>
<p>在 R 里，主要有两大底层图形系统，一是 base 图形系统，二是 grid 图形系统。 lattice 包与 ggplot2包正是基于 grid 图形系统构建的，它们都有自己独特的图形语法。grid 图形系统可以很容易地控制图形基础单元，给予编程者创作图形极大的灵活性。 grid 图形系统还可以产生可编辑的图形组件，这些图形组件可以被复用和重组，并能通过 grid.layout()等函数，把图形输出到指定的位置上。但是因为 grid 包中没有提供生成统计图形及完整绘图的函数，因此很少直接采用 grid 包来分析与展示数据。lattice 包通过一维、二维或三维条件绘图，即所谓的栅栏（trellis）图来对多元变量关系进行直
观展示。 相比于 base()函数是直接在图形设备上绘图的，lattice()函数是返回 trellis 对象。在命令执行的时候，栅栏图会被自动打印，所以看起来就像是 lattice()函数直接完成了绘图。 更多关于 base、grid 和 lattice 的语法可以参考 Murrell 和 Paul 所撰写的书籍 R graphics。ggplot2 包则基于一种全面的图形语法，提供了一种全新的图形创建方式，这套图形语法把绘图过程归纳为数据（data）、转换（transformation）、 度量（scale）、 坐标系（coordinate）、元素（element）、指引（guide）、显示（display）等一系列独立的步骤，通过将这些步骤搭配组合，来实现个性化的统计绘图。于是，得益于该图形语法，Hadley Wickham 所开发的 ggplot2 包是如此人性化，不同于 R base基础绘图和先前的 lattice 包那样参数繁多，而是摈弃了诸多烦琐细节，并以人性化的思维进行高质量作图。在 ggplot2 包中，加号（+）的引入是革命性的，这个神奇的符号完成了一系列图形语法叠加。 更多 ggplot2 的使用与学习可以参考两本关于 ggplot2 的经典书籍：ggplot2 Elegant Graphicsfor Data Analysis 和 R Graphics Cookbook。R 语言基础安装中就包含 base、 grid 和 lattice 三个包，无须另外下载。但是除了 base 包，其他包依旧需要使用 library()函数加载后，才能被使用。 
<img alt="" src="https://cdn.nlark.com/yuque/0/2020/png/1234840/1609075535563-69eabc81-7427-490d-b75e-80d3235eb734.png#crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;height=330&amp;id=e4RK7&amp;originHeight=330&amp;originWidth=960&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=0&amp;status=done&amp;style=none&amp;title=&amp;width=960" /></p>
<h2 id="1base"><strong>1.base系统</strong><a class="headerlink" href="#1base" title="Permanent link">&para;</a></h2>
<p>• 由Ross Ihaka编写
• base图形是最古老的系统，在R的初期就存在
• 容易上手
• 修改方便，使用灵活
• 不一定非常美观，需要调整参数修改
• 使用较多 
<div class="highlight"><pre><span></span><code>###-------------1.基础绘图函数plot绘制散点图
rm(list = ls())
x &lt;- runif(100,0,2)
y &lt;- runif(100,0,2)
plot(x, y, type=&quot;n&quot;, xlab=&quot;&quot;, ylab=&quot;&quot;, axes=F) 
points(x,y) #添加坐标点
axis(1) #添加横轴
axis(at=seq(0,2,0.5), side=2) #添加纵轴
box() #补齐散点图的边框
title(main=&quot;散点图&quot;, sub=&quot;subtitle&quot;, xlab=&quot;x轴&quot;, ylab=&quot;y轴&quot;)
abline(h=1,v=1,col=&quot;red&quot;)
</code></pre></div></p>
<p><img alt="" src="https://cdn.nlark.com/yuque/0/2020/png/1234840/1609075535535-0e68c3f8-ab71-4ab4-bd77-253a00d1a2c2.png#crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;height=643&amp;id=cm6cH&amp;originHeight=643&amp;originWidth=786&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=0&amp;status=done&amp;style=none&amp;title=&amp;width=786" /></p>
<h2 id="2grid"><strong>2.grid系统</strong><a class="headerlink" href="#2grid" title="Permanent link">&para;</a></h2>
<p>grid 图形系统可以很容易地控制图形基础单元，由Paul Murrell（2006）编写，给予编程者创作图形极大的灵活性。 grid 图形系统还可以产生可编辑的图形组件，这些图形组件可以被复用和重组，并能通过 grid.layout()等函数，把图形输出到指定的位置上。但是因为 grid 包中没有提供生成统计图形及完整绘图的函数，因此很少直接采用 grid 包来分析与展示数据。 </p>
<h2 id="3lattice"><strong>3.lattice系统</strong><a class="headerlink" href="#3lattice" title="Permanent link">&para;</a></h2>
<p>lattice 包通过一维、二维或三维条件绘图，即所谓的栅栏（trellis）图来对多元变量关系进行直观展示。 相比于 base()函数是直接在图形设备上绘图的，lattice()函数是返回 trellis 对象。在命令执行的时候，栅栏图会被自动打印，所以看起来就像是 lattice()函数直接完成了绘图。 更多关于 base、grid 和 lattice 的语法可以参考 Murrell 和 Paul 所撰写的书籍 R graphics。
<div class="highlight"><pre><span></span><code>###-------------2.利用lattice包xyplot函数绘制散点图
library(lattice)
z &lt;- rnorm(100)
df &lt;- data.frame(z=z,y=y,g=c(&quot;A&quot;,&quot;B&quot;))
xyplot(y~z,df)
title(main=&quot;散点图&quot;, sub=&quot;subtitle&quot;, xlab=&quot;x轴&quot;, ylab=&quot;y轴&quot;)
</code></pre></div></p>
<p><img alt="" src="https://cdn.nlark.com/yuque/0/2020/png/1234840/1609075535861-e0bb8aa5-f193-495e-a464-8b84f4298a64.png#crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;height=627&amp;id=VLf66&amp;originHeight=627&amp;originWidth=775&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=0&amp;status=done&amp;style=none&amp;title=&amp;width=775" />
<div class="highlight"><pre><span></span><code>###2.2 统计直方图
histogram(~z,df,type = &quot;count&quot;)
</code></pre></div></p>
<p><img alt="" src="https://cdn.nlark.com/yuque/0/2020/png/1234840/1609075535589-9f18788b-5301-4318-8bb4-0b576f120235.png#crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;height=608&amp;id=VuTjl&amp;originHeight=608&amp;originWidth=772&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=0&amp;status=done&amp;style=none&amp;title=&amp;width=772" /></p>
<h2 id="4ggplot2"><strong>4.ggplot2系统</strong><a class="headerlink" href="#4ggplot2" title="Permanent link">&para;</a></h2>
<p>ggplot2 是一个功能强大且灵活的 R 包，由 Hadley Wickham 编写，它可以生成优雅而实用的图形。 ggplot2 中的 gg 表示图形语法（grammar of graphic），这是一个通过使用“语法” 来绘图的图形概念。 ggplot2 主张模块间的协调与分工，整个 ggplot2 的语法框架如下图所示，主要包括数据绘图部分与美化细节部分。 R ggplot2 图形语法的主要特点如下所示。
（1）采用图层的设计方式，有利于结构化思维实现数据可视化。有明确的起始（ggplot()开始）与终止，图层之间的叠加是靠“+”实现的，越往后，其图层越在上方。通常一条 geom_xxx()函数或 stat_xxx()函数可以绘制一个图层。
（2）将表征数据和图形细节分开，能快速将图形表现出来，使创造性的绘图更加容易实现。而且通过 stat_xxx()函数将常见的统计变换融入绘图中。
（3）图形美观，扩展包（extension package）丰富，有专门调整颜色（color）、字体（font）和主题（theme）等辅助包。可以帮助用户快读定制个性化的图表。 
<img alt="" src="https://cdn.nlark.com/yuque/0/2020/png/1234840/1609075535553-8def2ded-039b-4451-b11d-564bcec1ffdf.png#crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;height=512&amp;id=R2FXu&amp;originHeight=512&amp;originWidth=1075&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=0&amp;status=done&amp;style=none&amp;title=&amp;width=1075" />
ggplot2 的绘图基本语法结构如上图所示。其中所需的图表输入信息如下所示。 
（1）ggplot()：底层绘图函数。 DATA 为数据集，主要是数据框（data.frame）格式的数据集；MAPPINGS 变量的视觉通道映射，用来表示变量 x 和 y，还可以用来控制颜色（color）、大小（size）或形状（shape）等视觉通道；STAT 表示统计变换，与 stat_xxx()相对应，默认为"identity"（无数据变换）；POSITION 表示绘图数据系列的位置调整，默认为"identity"（无位置调整）。
（2）geom_xxx() | stat_xxx()：几何图层或统计变换，比如常见的 geom_point()（散点图）、geom_bar()（柱形图）、 geom_histogram()（统计直方图）、 geom_ boxplot()（箱形图）、 geom_line()（折线图）等。我们通常使用 geom_xxx()函数就可以绘制大部分图表，有时候通过设定 stat 参数可以先实现统计变换。
可选的图表输入信息包括如下 5 个部分，主要是实现图表的美化与变换等。
（1）scale_xxx()：度量调整，调整具体的度量，包括颜色（color）、大小（size）或形状（shape）等，跟 MAPPINGS 的映射变量相对应；
（2）coord_xxx()：坐标变换，默认笛卡儿坐标系，还包括极坐标系、地理空间坐标系等；
（3）facet_xxx()：分面系统，将某个变量进行分面变换，包括按行、列和网格等形式分面绘图。
（4）guides()：图例调整，主要包括连续型和离散型两种类型的图例。 
（5）theme()：主题设定，主要用于调整图表的细节，包括图表背景颜色、网格线的间隔与颜色等。
<img alt="" src="https://cdn.nlark.com/yuque/0/2020/png/1234840/1609075535516-a4b9c055-eeb3-4b79-a07d-c54c9bac1bcc.png#crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;height=301&amp;id=cKEZa&amp;originHeight=301&amp;originWidth=651&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=0&amp;status=done&amp;style=none&amp;title=&amp;width=651" /> </p>
<h2 id="5"><strong>5.常见的绘图参数</strong><a class="headerlink" href="#5" title="Permanent link">&para;</a></h2>
<p>低水平绘图函数
<div class="highlight"><pre><span></span><code>lines() 添加线
curve() 添加曲线
abline() 添加给定斜率的线
points() 添加点
segments() 折线
arrows() 箭头
axis() 坐标轴
box() 外框
title() 标题
text() 文字
mtext() 图边文字
</code></pre></div></p>
<p>高水平绘图函数
<div class="highlight"><pre><span></span><code>plot() 绘制散点图等多种图形
hist() 直方图
boxplot() 箱线图
stripchart() 点图
barplot() 条形图
dotplot() 点图
piechart() 饼图
interaction.plot()
matplot()
</code></pre></div></p>
<p>常用的绘图参数
参数用在函数内部，在没有设定值时使用默认值。
<div class="highlight"><pre><span></span><code>font= 字体
lty= 线类型
lwd= 线宽度
pch= 点的类型
xlab= 横坐标
ylab= 纵坐标
xlim= 横坐标范围
ylim= 纵坐标范围
</code></pre></div></p>
<div class="highlight"><pre><span></span><code>pch：指定绘制点所使用的符号，取值范围[0, 24]，其中4是“差号”，20是“点”
cex：指定符号的大小。cex是一个数值，表示pch的倍数，默认是1.5倍
lty：指定线条类型。lty=1代表实线，2至6都是虚线，虚的程度不一样
lwd：指定线条宽度，默认值为lwd=1，可以适当修改1.5倍、2倍等
</code></pre></div>
<div class="highlight"><pre><span></span><code>col：默认绘图颜色。某些函数(如lines、pie)可以接受一个含有颜色值的向量，并自动循环使用。
       例如：col=c(&quot;red&quot;, &quot;blue&quot;)需要绘制三条线，那么三条颜色分别为red、blue、red
col.axis：坐标轴刻度文字的颜色，不是坐标轴的颜色
col.lab：坐标轴标签(名称)的颜色
col.main：标题的颜色
col.sub：副标题的颜色
fg：图形的前景色
bg：图形的背景色
</code></pre></div>
<div class="highlight"><pre><span></span><code>cex.axis：坐标轴刻度文字的缩放倍数
cex.lab：坐标轴标签(名称)的缩放倍数
cex.main：标题的缩放倍数
cex.sub：副标题的缩放倍数
font：整数。用于指定字体样式。1常规、2粗体、3斜体、4粗斜体
</code></pre></div>
<div class="highlight"><pre><span></span><code>pin：以英寸表示图形的宽和高
mai：以数值向量表示边界大小，顺序为&quot;下、左、上、右&quot;，单位为英寸
mar：以数值向量表示边界大小，顺序为&quot;下、左、上、右&quot;，单位为英分，默认值c(5, 4, 4, 2)+0.1
</code></pre></div>
<div class="highlight"><pre><span></span><code>主标题可以使用函数title，格式为：
 title(main = &quot; &quot;, sub = &quot; &quot;, xlab = &quot; &quot;,  ylab = &quot; &quot;)
</code></pre></div>
<h1 id="ggplot2"><strong>二.ggplot2绘图框架</strong><a class="headerlink" href="#ggplot2" title="Permanent link">&para;</a></h1>
<h2 id="1geom_stat_"><strong>1.geom_</strong>()与stat_<strong>()</strong><a class="headerlink" href="#1geom_stat_" title="Permanent link">&para;</a></h2>
<p>geom_**()相关函数如下：
<img alt="" src="https://cdn.nlark.com/yuque/0/2020/png/1234840/1609075535752-37f31826-7761-4d8e-ad5c-b88ba8611e49.png#crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;height=370&amp;id=SFcwn&amp;originHeight=370&amp;originWidth=912&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=0&amp;status=done&amp;style=none&amp;title=&amp;width=912" />
其他的可通过下面代码查看：
<div class="highlight"><pre><span></span><code>library(ggplot2)
#查看在ggplot2包中有什么geom_**()开头的函数
ls(pattern = &quot;^geom_&quot;, env = as.environment(&quot;package:ggplot2&quot;))
</code></pre></div></p>
<p>stat_**()相关函数如下：
<div class="highlight"><pre><span></span><code>ls(pattern = &quot;^stat_&quot;, env = as.environment(&quot;package:ggplot2&quot;))
</code></pre></div></p>
<p>| </p>
<p>函数 | </p>
<p>函数说明 |
| --- | --- |
| </p>
<p>stat_bin | </p>
<table>
<thead>
<tr>
<th>Histograms   and frequency polygons</th>
</tr>
</thead>
<tbody>
<tr>
<td></td>
</tr>
</tbody>
</table>
<p>stat_bin2d | </p>
<table>
<thead>
<tr>
<th>Heatmap   of 2d bin counts</th>
</tr>
</thead>
<tbody>
<tr>
<td></td>
</tr>
</tbody>
</table>
<p>stat_binhex | </p>
<table>
<thead>
<tr>
<th>Hexagonal   heatmap of 2d bin counts</th>
</tr>
</thead>
<tbody>
<tr>
<td></td>
</tr>
</tbody>
</table>
<p>stat_bin_2d | </p>
<table>
<thead>
<tr>
<th>Heatmap   of 2d bin counts</th>
</tr>
</thead>
<tbody>
<tr>
<td></td>
</tr>
</tbody>
</table>
<p>stat_bin_hex | </p>
<table>
<thead>
<tr>
<th>Hexagonal   heatmap of 2d bin counts</th>
</tr>
</thead>
<tbody>
<tr>
<td></td>
</tr>
</tbody>
</table>
<p>stat_boxplot | </p>
<table>
<thead>
<tr>
<th>A   box and whiskers plot (in the style of Tukey)</th>
</tr>
</thead>
<tbody>
<tr>
<td></td>
</tr>
</tbody>
</table>
<p>stat_contour | </p>
<table>
<thead>
<tr>
<th>2d   contours of a 3d surface</th>
</tr>
</thead>
<tbody>
<tr>
<td></td>
</tr>
</tbody>
</table>
<p>stat_count | </p>
<table>
<thead>
<tr>
<th>Bar   charts</th>
</tr>
</thead>
<tbody>
<tr>
<td></td>
</tr>
</tbody>
</table>
<p>stat_density | </p>
<table>
<thead>
<tr>
<th>Smoothed   density estimates</th>
</tr>
</thead>
<tbody>
<tr>
<td></td>
</tr>
</tbody>
</table>
<p>stat_density2d | </p>
<table>
<thead>
<tr>
<th>Contours   of a 2d density estimate</th>
</tr>
</thead>
<tbody>
<tr>
<td></td>
</tr>
</tbody>
</table>
<p>stat_density_2d | </p>
<table>
<thead>
<tr>
<th>Contours   of a 2d density estimate</th>
</tr>
</thead>
<tbody>
<tr>
<td></td>
</tr>
</tbody>
</table>
<p>stat_ecdf | </p>
<table>
<thead>
<tr>
<th>Compute   empirical cumulative distribution</th>
</tr>
</thead>
<tbody>
<tr>
<td></td>
</tr>
</tbody>
</table>
<p>stat_ellipse | </p>
<table>
<thead>
<tr>
<th>Compute   normal confidence ellipses</th>
</tr>
</thead>
<tbody>
<tr>
<td></td>
</tr>
</tbody>
</table>
<p>stat_function | </p>
<table>
<thead>
<tr>
<th>Compute   function for each x value</th>
</tr>
</thead>
<tbody>
<tr>
<td></td>
</tr>
</tbody>
</table>
<p>stat_identity | </p>
<table>
<thead>
<tr>
<th>Leave   data as is</th>
</tr>
</thead>
<tbody>
<tr>
<td></td>
</tr>
</tbody>
</table>
<p>stat_qq | </p>
<table>
<thead>
<tr>
<th>A   quantile-quantile plot</th>
</tr>
</thead>
<tbody>
<tr>
<td></td>
</tr>
</tbody>
</table>
<p>stat_qq_line | </p>
<table>
<thead>
<tr>
<th>A   quantile-quantile plot</th>
</tr>
</thead>
<tbody>
<tr>
<td></td>
</tr>
</tbody>
</table>
<p>stat_quantile | </p>
<table>
<thead>
<tr>
<th>Quantile   regression</th>
</tr>
</thead>
<tbody>
<tr>
<td></td>
</tr>
</tbody>
</table>
<p>stat_sf | </p>
<table>
<thead>
<tr>
<th>Visualise   sf objects</th>
</tr>
</thead>
<tbody>
<tr>
<td></td>
</tr>
</tbody>
</table>
<p>stat_sf_coordinates | </p>
<table>
<thead>
<tr>
<th>Extract   coordinates from 'sf' objects</th>
</tr>
</thead>
<tbody>
<tr>
<td></td>
</tr>
</tbody>
</table>
<p>stat_smooth | </p>
<table>
<thead>
<tr>
<th>Smoothed   conditional means</th>
</tr>
</thead>
<tbody>
<tr>
<td></td>
</tr>
</tbody>
</table>
<p>stat_spoke | </p>
<table>
<thead>
<tr>
<th>Line   segments parameterised by location, direction and distance</th>
</tr>
</thead>
<tbody>
<tr>
<td></td>
</tr>
</tbody>
</table>
<p>stat_sum | </p>
<table>
<thead>
<tr>
<th>Count   overlapping points</th>
</tr>
</thead>
<tbody>
<tr>
<td></td>
</tr>
</tbody>
</table>
<p>stat_summary | </p>
<table>
<thead>
<tr>
<th>Summarise   y values at unique/binned x</th>
</tr>
</thead>
<tbody>
<tr>
<td></td>
</tr>
</tbody>
</table>
<p>stat_summary2d | </p>
<table>
<thead>
<tr>
<th>Bin   and summarise in 2d (rectangle &amp; hexagons)</th>
</tr>
</thead>
<tbody>
<tr>
<td></td>
</tr>
</tbody>
</table>
<p>stat_summary_2d | </p>
<table>
<thead>
<tr>
<th>Bin   and summarise in 2d (rectangle &amp; hexagons)</th>
</tr>
</thead>
<tbody>
<tr>
<td></td>
</tr>
</tbody>
</table>
<p>stat_summary_bin | </p>
<table>
<thead>
<tr>
<th>Summarise   y values at unique/binned x</th>
</tr>
</thead>
<tbody>
<tr>
<td></td>
</tr>
</tbody>
</table>
<p>stat_summary_hex | </p>
<table>
<thead>
<tr>
<th>Bin   and summarise in 2d (rectangle &amp; hexagons)</th>
</tr>
</thead>
<tbody>
<tr>
<td></td>
</tr>
</tbody>
</table>
<p>stat_unique | </p>
<table>
<thead>
<tr>
<th>Remove   duplicates</th>
</tr>
</thead>
<tbody>
<tr>
<td></td>
</tr>
</tbody>
</table>
<p>stat_ydensity | </p>
<p>Violin   plot |</p>
<div class="highlight"><pre><span></span><code>set.seed(1492)
ggplot(data.frame(x = rnorm(100)), aes(x)) +
  geom_density() +
  stat_function(fun = dnorm, colour = &quot;red&quot;)
ggplot(data.frame(x = c(-5, 5)), aes(x))+ 
  stat_function(fun = dnorm)
</code></pre></div>
<h2 id="2"><strong>2.视觉通道</strong><a class="headerlink" href="#2" title="Permanent link">&para;</a></h2>
<p><img alt="" src="https://cdn.nlark.com/yuque/0/2020/png/1234840/1609075535843-1e001c50-244c-4960-a3f0-dc76dd3d6d3e.png#crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;height=236&amp;id=NoUIk&amp;originHeight=236&amp;originWidth=644&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=0&amp;status=done&amp;style=none&amp;title=&amp;width=644" />
绘制几个图看看：
<div class="highlight"><pre><span></span><code>f1 &lt;- ggplot(df, aes(x=SOD,y=tau,size=age)) + 
  geom_point(shape=21,color=&quot;black&quot;,fill=&quot;#336A97&quot;,stroke=0.25)
f2 &lt;- ggplot(df, aes(SOD,tau,fill=age,size=age)) + 
  geom_point(shape=21,colour=&quot;black&quot;,stroke=0.25,
             alpha=0.8) 
f3 &lt;- ggplot(df, aes(x=SOD,y=tau,fill=Class)) + 
  geom_point(shape=21,size=3,colour=&quot;black&quot;,stroke=0.25)
f4 &lt;- ggplot(df, aes(SOD,tau,fill=Class,size=age)) + 
  geom_point(shape=21,colour=&quot;black&quot;,stroke=0.5,
             alpha=0.8)
f1 + f2 + f3 + f4 
library(gridExtra) 
grid.arrange(f1,f2,f3,f4, ncol = 2, nrow =2)
</code></pre></div></p>
<p><img alt="" src="https://cdn.nlark.com/yuque/0/2020/png/1234840/1609075535766-4314a6b2-1cfb-40a8-8560-0200dbdcdf92.png#crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;height=497&amp;id=PuafR&amp;originHeight=991&amp;originWidth=1912&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=0&amp;status=done&amp;style=none&amp;title=&amp;width=958" /></p>
<h2 id="3"><strong>3.度量调整</strong><a class="headerlink" href="#3" title="Permanent link">&para;</a></h2>
<p><img alt="" src="https://cdn.nlark.com/yuque/0/2020/png/1234840/1609075535929-b532353e-f659-470b-b645-6990fff79c44.png#crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;height=428&amp;id=SloRz&amp;originHeight=428&amp;originWidth=692&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=0&amp;status=done&amp;style=none&amp;title=&amp;width=692" />
<div class="highlight"><pre><span></span><code>###4.度量调整-------------------
head(df)
ggplot(df, aes(x=SOD,y=tau,size=age)) + 
  geom_point(shape=21,color=&quot;black&quot;,fill=&quot;#E53F2F&quot;,stroke=0.25,alpha=0.8)+
  scale_size(range = c(1, 8))#range:长度为2的数字向量，指定转换后绘图符号的最小和最大大小。
ggplot(df, aes(SOD,tau,fill=age,size=age)) + 
  geom_point(shape=21,colour=&quot;black&quot;,stroke=0.25,
             alpha=1)+
  scale_size(range = c(1,8))+
  scale_fill_distiller(palette=&quot;Reds&quot;) 
ggplot(df, aes(x=SOD,y=tau,fill=Class,shape=Class)) + 
  geom_point(size=3,colour=&quot;black&quot;,stroke=0.25)+
  scale_fill_manual(values=c(&quot;#36BED9&quot;,&quot;#FF0000&quot;,&quot;#FBAD01&quot;))+
  scale_shape_manual(values=c(21,22,23))
ggplot(df, aes(SOD,tau,fill=Class,size=age)) + 
  geom_point(shape=21,colour=&quot;black&quot;,stroke=0.25,
             alpha=0.8) +
  scale_fill_manual(values=c(&quot;#36BED9&quot;,&quot;#FF0000&quot;,&quot;#FBAD01&quot;))+
  scale_size(range = c(1, 8))
</code></pre></div></p>
<h2 id="4"><strong>4.坐标系</strong><a class="headerlink" href="#4" title="Permanent link">&para;</a></h2>
<p>ggplot2的直角坐标系包括coord_cartesian()、coord_fixed()、coord.fip()和coord_ trans()四种类型。ggplot2中的默认类型为coord.cartesian() ,我们在绘制条形图或者水平箱形图时，需要使用coord_fip()翻转坐标系。它会将X轴和Y轴坐标对换，从而可以将竖直的柱形图转换成水平的条形图。</p>
<h2 id="5_1"><strong>5.图例</strong><a class="headerlink" href="#5_1" title="Permanent link">&para;</a></h2>
<p>图例作为图表背景信息的重要组成部分，对图表的完整与正确表达尤为重要。ggplot2 的guide_colorbar()/guide_colourbar()函数用于调整连续变量的图例; guide_legend()函数用于离散变量的图例，也可以用于连续变量。guides()函数将guide_colorbar()和guide_colourbar()两种图例嵌套进去，方面映射处理，如：guides(fill = guide_colourbar())，对多个图例共同处理尤为有效。</p>
<h2 id="6"><strong>6.分面系统</strong><a class="headerlink" href="#6" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code>##-------------6.分面系统
ls(pattern = &quot;^facet_&quot;, env = as.environment(&quot;package:ggplot2&quot;))
head(mpg)
ggplot(mpg, aes(displ, cty)) + geom_point()
ggplot(mpg, aes(displ, cty)) + 
  geom_point()+
  facet_grid(rows = vars(drv))
ggplot(mpg, aes(drv, model)) +
  geom_point() +
  facet_grid(manufacturer ~ ., scales = &quot;free&quot;, space = &quot;free&quot;) +
  theme(strip.text.y = element_text(angle = 0))
ggplot(mpg, aes(displ, hwy)) + geom_point()
# Use vars() to supply faceting variables:
ggplot(mpg, aes(displ, hwy)) + 
  geom_point() + 
  facet_wrap(vars(class))
# The historical interface with formulas is also available:
ggplot(mpg, aes(displ, hwy)) + 
  geom_point() + 
  facet_wrap(~class)
# Control the number of rows and columns with nrow and ncol
ggplot(mpg, aes(displ, hwy)) + 
  geom_point() +
  facet_wrap(vars(class), nrow = 4)
# You can facet by multiple variables
ggplot(mpg, aes(displ, hwy)) +
  geom_point() +
  facet_wrap(vars(cyl, drv))
View(mpg)
</code></pre></div>
<h2 id="7"><strong>7.主题</strong><a class="headerlink" href="#7" title="Permanent link">&para;</a></h2>
<p>主题系统包括绘图区背景、网格线、坐标轴线条等图表的细节部分，而图表风格主要是指绘图区背景、网格线、坐标轴线条等的格式设定所展现的效果。ggplot2图表的主题系统的主要对象包括文本(text)、矩形(rect) 和线条(line )三大类，对应的函数包括element _text()、element_rect()、element_line()， 另外还有element_blank()表示该对象设置为无，具体如表所示。其中，我们使用比较多的系统对象是坐标轴的标签( axis.text.x、axis.text.y )、图例的位置与背景( legend.position 和legend.background)。X轴标签(axis.text.x)在绘制极坐标柱形图和径向柱形图时会用于调整X轴标签的旋转角度，Y轴标签( axis.text.y)也会用于时间序列峰峦图的Y轴标签的替换等，具体可见后面图表案例的讲解。
<img alt="" src="https://cdn.nlark.com/yuque/0/2020/png/1234840/1609075535822-84e4bd8f-d33b-4b5b-84a9-72275e1533e7.png#crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;height=407&amp;id=QIPH7&amp;originHeight=407&amp;originWidth=950&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=0&amp;status=done&amp;style=none&amp;title=&amp;width=950" />
一些主题相关包:ggThemeAssist,ggthemes,ggtech,ggthemer,<strong>ggsci</strong>,cowplot等。</p>
<h2 id="8"><strong>8.位置调整</strong><a class="headerlink" href="#8" title="Permanent link">&para;</a></h2>
<p><img alt="" src="https://cdn.nlark.com/yuque/0/2020/png/1234840/1609075535919-a4ea2bff-f600-4d52-9775-a54af30a8e61.png#crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;height=352&amp;id=zmEFA&amp;originHeight=352&amp;originWidth=941&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=0&amp;status=done&amp;style=none&amp;title=&amp;width=941" /></p>
<h2 id="9"><strong>9.学术文章图标配色</strong><a class="headerlink" href="#9" title="Permanent link">&para;</a></h2>
<p>RColorBrewer包是比较常用的调色板，来自网站:<a href="https://colorbrewer2.org/">https://colorbrewer2.org/</a><br />
brewer.pal()函数获取颜色
<div class="highlight"><pre><span></span><code>brewer.pal(n, name)#使颜色调色板；Name的值：Blues BuGn BuPu GnBu Greens Greys Oranges OrRd PuBu PuBuGn PuRd Purples RdPu Reds YlGn YlGnBu YlOrBr YlOrRd
</code></pre></div></p>
<p>display.brewer.pal() 函数在图形窗口中显示选定的调色板，在图形窗口中同时显示一些调色板。有3种类型的调色板:sequential, diverging, and qualitative。display.brewer.all(n=NULL, type="all", select=NULL, exact.n=TRUE, colorblindFriendly=FALSE)。
brewer.pal.info #将可用调色板的信息作为数据文件返回
colorfavs工具链接：<a href="http://www.colorfavs.com/">http://www.colorfavs.com/</a></p>
<h2 id="10"><strong>10.排版布局</strong><a class="headerlink" href="#10" title="Permanent link">&para;</a></h2>
<p>ggplot2组合图形布局可以使用Rmisc包的multiplot()函数，也可以使用ggpubr包的ggarrange()函数。
patchwork包中用来调整排版设置的函数有plot_annotation()函数、plot_layout()函数、plot_spacer()函数等，下面一个一个看。
plot_annotation()函数
可以使用title、subtitle、caption等参数来控制图形标题和副标题等。使用tag_levels参数表示添加图形的标签，可以指定水平值为a、A、1、i、I等，分别表示小写字母、大写字母、数字、小写罗马数字、大写罗马数字等。
plot_layout()函数排版
上面的plot_annotation()函数是用于添加组合图形的标签、标题等。而plot_layout()函数可以用于组合图形的布局。
library(easyGgplot2) 包的ggplot2.multiplot函数
用gredExtra包grid.arrange函数
用cowplot包的plot_grid函数
<div class="highlight"><pre><span></span><code>library(Rmisc)
multiplot(fig1,fig2,fig3,fig4, cols = 2)
multiplot(fig1,fig2,fig5, layout = matrix(c(1,2,3,3),ncol = 2,byrow = T))
#ggpubr包的ggarrange()函数
ggarrange(fig1,fig2,fig3,fig2,# 要布局的图形
          ncol = 2,nrow = 2) # 图形排版为2列
#patchwork包的plot_layout()函数
fig1 + fig3 + fig2 + 
  plot_layout(ncol = 2, byrow = TRUE)
#除了用+号运算来排版图形外，还可以使用/号来排版。
fig1/fig2
fig3 | (fig1/fig2)
(fig1 + fig3)/ fig5 + 
  plot_annotation(tag_levels = &quot;A&quot;,
                  title = &quot;组合图形排版&quot;,
                  caption = &quot;公众号:BioInfoNotes&quot;)
#图形设置为两列，默认按行填充，两列之间相对宽度比为1：2
fig1 + fig3 + fig2 + plot_layout(ncol = 2, widths = c(1, 2))
#plot_spacer()函数就是在前后图形中创建一个空的透明网格
fig1 + fig3 + plot_spacer()+fig2 
library(gridExtra) 
grid.arrange(fig1,fig2,fig5, ncol = 2, nrow =2,layout_matrix=matrix(c(1,2,3,3),ncol = 2,byrow = T))
</code></pre></div></p>
<p>绘图经典案例:<a href="http://www.sthda.com/english/wiki/ggplot2-essentials">ggplot2 - Essentials - Easy Guides - Wiki - STHDA</a></p>
<p>最后一个是 https://stackoverflow.com/</p>
<p>你会发现，你想实现的各种稀奇古怪的绘图需求，只需要你能使用英文描述出来，就是能找到答案的！</p>
<ul>
<li>用谷歌搜索来使用ggplot2做可视化（上）：https://mp.weixin.qq.com/s/WN4TSMNjH4b6vZgYVjaRvQ</li>
<li>用谷歌搜索来使用ggplot2做可视化（下）：https://mp.weixin.qq.com/s/_Q16zDZgCr3XoO0r3wqRkw</li>
</ul>
<h1 id="_1"><strong>三.散点图</strong><a class="headerlink" href="#_1" title="Permanent link">&para;</a></h1>
<h2 id="1plot"><strong>1.利用plot()绘制散点图</strong><a class="headerlink" href="#1plot" title="Permanent link">&para;</a></h2>
<p>R语言中plot()函数的基本格式如下：
<div class="highlight"><pre><span></span><code>plot(x,y,...)
</code></pre></div></p>
<p>plot函数中，x和y分别表示所绘图形的横坐标和纵坐标；函数中的...为附加的参数。
plot函数默认的使用格式如下：</p>
<div class="highlight"><pre><span></span><code>plot(x, y = NULL, type = &quot;p&quot;, xlim = NULL, ylim = NULL, log = &quot;&quot;, main = NULL, sub = NULL, xlab = NULL, ylab = NULL, ann = par(&quot;ann&quot;), axes = TRUE, frame.plot = axes, panel.first = NULL, panel.last = NULL, asp = NA, ...)
</code></pre></div>
<p>主要参数的含义如下：
（1）type为一个字符的字符串，用于给定绘图的类型，可选的值如下：
"p"：绘点（默认值）；
"l"：绘制线；
"b"：同时绘制点和线；
"c"：仅绘制参数"b"所示的线；
"o"：同时绘制点和线，且线穿过点；
"h"：绘制出点到横坐标轴的垂直线；
"s"：绘制出阶梯图（先横后纵）；
"S"：绘制出阶梯图（先纵后竖）；
"n"：作空图。
（2）main参数 字符串，给出图形的标题；
（3）sub参数 字符串，给出图形的子标题；
（4）xlab 和 ylab参数 字符串，用于给出x轴和y轴的标签。
（5）xlim 和 ylim参数 都是二维向量，分别表示x轴和y轴的取值范围。
（6）pch参数：
<img alt="" src="https://cdn.nlark.com/yuque/0/2020/png/1234840/1609075535558-b185006c-1b9b-492a-8495-c3f4dd9c6da2.png#crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;height=402&amp;id=GKZM3&amp;originHeight=566&amp;originWidth=1078&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=0&amp;status=done&amp;style=none&amp;title=&amp;width=766" />
<img alt="" src="https://cdn.nlark.com/yuque/0/2020/png/1234840/1609075535580-341096ee-6e40-4905-9577-c5bd828ba8d1.png#crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;height=561&amp;id=VfwWa&amp;originHeight=561&amp;originWidth=680&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=0&amp;status=done&amp;style=none&amp;title=&amp;width=680" /></p>
<div class="highlight"><pre><span></span><code>####第二个图
x &lt;- runif(50,0,2)
y &lt;- runif(50,0,2)
plot(x, y, type=&quot;n&quot;, xlab=&quot;&quot;, ylab=&quot;&quot;, axes=F) 
points(x,y) #添加坐标点
axis(1) #添加横轴
axis(at=seq(0,2,0.5), side=2) #添加纵轴
box() #补齐散点图的边框
title(main=&quot;散点图&quot;, sub=&quot;subtitle&quot;, xlab=&quot;x轴&quot;, ylab=&quot;y轴&quot;)
abline(h=0.6,v=0.6,col=&quot;red&quot;)
</code></pre></div>
<p><img alt="" src="https://cdn.nlark.com/yuque/0/2020/png/1234840/1609075535564-9c2742c8-169c-4102-bf5e-50f9cfdc312b.png#crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;height=559&amp;id=xS5BX&amp;originHeight=559&amp;originWidth=679&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=0&amp;status=done&amp;style=none&amp;title=&amp;width=679" /></p>
<div class="highlight"><pre><span></span><code>data(trees) # 加载数据集
head(trees) # 预览数据集
</code></pre></div>
<p><img alt="" src="https://cdn.nlark.com/yuque/0/2020/png/1234840/1609075535741-bf03c4c6-d3e4-481b-bcaa-bfea140baaf4.png#crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;height=238&amp;id=bOxY7&amp;originHeight=238&amp;originWidth=480&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=0&amp;status=done&amp;style=none&amp;title=&amp;width=480" /></p>
<h2 id="2ggplot2"><strong>2.ggplot2()绘制散点图</strong><a class="headerlink" href="#2ggplot2" title="Permanent link">&para;</a></h2>
<p>利用ggplot2绘图，请记住下面这个格式，因为这个格式ggplot2绘制其他图形都是这一格式。
<div class="highlight"><pre><span></span><code>ggplot(data, aes(x, y)) + geom_point()
</code></pre></div></p>
<p>aes中的x,y值分别表示在x,y轴的变量；geom_point表示增加散点图图层。
散点图分组有两种方式，一种利用shape,以点的形状来区分各种；一种用color，以点的颜色来区分，但是得记住，分组的变量必须为因子变量或者字符串。</p>
<div class="highlight"><pre><span></span><code>ggplot(data, aes(x, y, colour)) + geom_point()#设置colour参数以颜色区分
ggplot(data, aes(x, y, shape)) + geom_point()#设置shape参数以形状区分
</code></pre></div>
<div class="highlight"><pre><span></span><code>###第三个图
library(ggplot2)
#read in data
#钻石克拉数和价格
data = read.table(&quot;scatter_plot.txt&quot;, header=T, sep=&quot;\t&quot;)
class(data)
head(data)
###只绘制10个点
ggplot(data[1:10,], aes(x=carat,y=price)) +
  geom_point()
</code></pre></div>
<p><img alt="" src="https://cdn.nlark.com/yuque/0/2020/png/1234840/1609075535581-a3011b1c-92e1-4a3b-9199-dee15efa794a.png#crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;height=553&amp;id=UAJIG&amp;originHeight=553&amp;originWidth=679&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=0&amp;status=done&amp;style=none&amp;title=&amp;width=679" /></p>
<div class="highlight"><pre><span></span><code>##画出所有的点
ggplot(data, aes(x=carat,y=price)) +
  geom_point()
</code></pre></div>
<p><img alt="" src="https://cdn.nlark.com/yuque/0/2020/png/1234840/1609075535560-eefa3674-c247-4f53-b22a-c0619122a5ec.png#crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;height=557&amp;id=J5iUD&amp;originHeight=557&amp;originWidth=672&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=0&amp;status=done&amp;style=none&amp;title=&amp;width=672" /></p>
<p>当点的密度大时，我们可以改变点的透明度来区分各个点。
当然我们可以使用bin的方法来区分，这种方法是把点的形状设定为长方形，密度越大的长方形区域越透明。
<div class="highlight"><pre><span></span><code>ggplot(data, aes(x=carat,y=price)) +
  geom_point(alpha=0.05)
</code></pre></div></p>
<p>通过alpha参数设置透明度，alpha是从0(完全透明)到1(不透明)的值。
<img alt="" src="https://cdn.nlark.com/yuque/0/2020/png/1234840/1609075535547-226d12c9-823b-4480-be10-0bc10bd1ba8a.png#crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;height=554&amp;id=EYaf9&amp;originHeight=554&amp;originWidth=680&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=0&amp;status=done&amp;style=none&amp;title=&amp;width=680" />
另一种方法是把点切到不同的箱子里。
<div class="highlight"><pre><span></span><code>ggplot(data, aes(x=carat,y=price)) +
  stat_bin2d()
</code></pre></div></p>
<p><img alt="" src="https://cdn.nlark.com/yuque/0/2020/png/1234840/1609075535607-203f4119-b3a8-4a38-a4bc-10c6b40b5a4c.png#crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;height=557&amp;id=qssFe&amp;originHeight=557&amp;originWidth=677&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=0&amp;status=done&amp;style=none&amp;title=&amp;width=677" />
<div class="highlight"><pre><span></span><code>ggplot(data, aes(x=carat,y=price)) +
  stat_bin2d(bins=50) +
  scale_fill_gradient(low=&quot;lightblue&quot;, high=&quot;red&quot; ,limits=c(0,5000))
</code></pre></div></p>
<p><img alt="" src="https://cdn.nlark.com/yuque/0/2020/png/1234840/1609075535561-358652ed-132b-4240-a591-3a63c48dacc3.png#crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;height=557&amp;id=oCLtG&amp;originHeight=557&amp;originWidth=678&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=0&amp;status=done&amp;style=none&amp;title=&amp;width=678" /></p>
<div class="highlight"><pre><span></span><code>#show the bins in hexagon using package hexbin
library(hexbin)
ggplot(data, aes(x=carat,y=price)) +
  stat_binhex() +
  scale_fill_gradient(low=&quot;lightblue&quot;, high=&quot;red&quot;, 
                      breaks=c(0, 250, 500, 1000, 2000, 4000, 6000),
                      limits=c(0,6000))
</code></pre></div>
<p><img alt="" src="https://cdn.nlark.com/yuque/0/2020/png/1234840/1609075535677-106ee198-cc98-4c07-935a-8ac47efdf9a8.png#crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;height=557&amp;id=r6SJt&amp;originHeight=557&amp;originWidth=677&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=0&amp;status=done&amp;style=none&amp;title=&amp;width=677" /></p>
<h1 id="_2"><strong>四.柱状图</strong><a class="headerlink" href="#_2" title="Permanent link">&para;</a></h1>
<div class="highlight"><pre><span></span><code>library(ggplot2)
library(RColorBrewer)
</code></pre></div>
<p>我们可以通过将 geom_bar() 中的参数指定为 colour="black" 为条形添加黑色边框线；可以通过 scale_fill_brewer() 或者 scale_fill_manual() 函数对图形颜色进行设置。颜色的映射设定是在 aes() 内部完成的，而颜色的重新设定是在 aes() 外部完成的 </p>
<h2 id="01"><strong>01.单数据系列柱形图</strong><a class="headerlink" href="#01" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code>mydata&lt;-data.frame(Cut=c(&quot;Fair&quot;,&quot;Good&quot;,&quot;Very Good&quot;,&quot;Premium&quot;,&quot;Ideal&quot;),
                    Price=c(4300,3800,3950,4700,3500))
#mydata$Cut &lt;- factor(mydata$Cut, levels = mydata$Cut[order(mydata$Order)])
ggplot(data=mydata,aes(x=Cut,y=Price))+
  geom_bar(stat = &quot;identity&quot;, 
           width = 0.8,colour=&quot;black&quot;,size=0.25,
           fill=&quot;#FC4E07&quot;,alpha=1)+
  ylim(0, 6000)+
  theme(
    axis.title=element_text(size=15,face=&quot;plain&quot;,color=&quot;black&quot;),
    axis.text = element_text(size=12,face=&quot;plain&quot;,color=&quot;black&quot;)
  )
</code></pre></div>
<p><img alt="" src="https://cdn.nlark.com/yuque/0/2020/png/1234840/1609075535598-4704fe0b-8a3f-48ad-85a2-1bb84f9489c3.png#crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;height=546&amp;id=D5b71&amp;originHeight=675&amp;originWidth=706&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=0&amp;status=done&amp;style=none&amp;title=&amp;width=571" />
图形排序
<div class="highlight"><pre><span></span><code>#排序方法1：基于数据框data.frame
library(dplyr)
mydata2&lt;-arrange(mydata,desc(Price))
mydata$Cut &lt;- factor(mydata$Cut, levels = mydata2$Cut)
ggplot(data=mydata,aes(Cut,Price))+ 
  geom_bar(stat = &quot;identity&quot;, width = 0.8,
           colour=&quot;black&quot;,size=0.25,fill=&quot;#FC4E07&quot;,alpha=1)
#排序方法2：基于向量vector
order&lt;-sort(mydata$Price,index.return=TRUE,decreasing = TRUE) 
mydata$Cut &lt;- factor(mydata$Cut, levels = mydata$Cut[order$ix]) 
ggplot(data=mydata,aes(Cut,Price))+ 
  geom_bar(stat = &quot;identity&quot;, width = 0.8,
           colour=&quot;black&quot;,size=0.25,fill=&quot;#FC4E07&quot;,alpha=1)
</code></pre></div></p>
<p><img alt="" src="https://cdn.nlark.com/yuque/0/2020/png/1234840/1609075535604-398bf88c-2117-48f8-b5a4-1bb177b85e09.png#crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;height=495&amp;id=YAlqg&amp;originHeight=672&amp;originWidth=701&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=0&amp;status=done&amp;style=none&amp;title=&amp;width=516" />
如果需要横向显示，加上coord_flip()语句
<div class="highlight"><pre><span></span><code>mydata&lt;-read.csv(&quot;Stackedbar_Data.csv&quot;,sep=&quot;,&quot;,na.strings=&quot;NA&quot;,stringsAsFactors=FALSE)
mydata$Country &lt;- factor(mydata$Country, levels = mydata$Country[order(mydata$Pensions)])
ggplot(data=mydata,aes(Country,Pensions))+
  geom_bar(stat=&quot;identity&quot;, color=&quot;black&quot;, width=0.6,fill=&quot;#FC4E07&quot;,size=0.25) +#&quot;#00AFBB&quot;
  scale_fill_manual(values=brewer.pal(9,&quot;YlOrRd&quot;)[c(6:2)])+
  coord_flip()+
  theme(
    axis.title=element_text(size=15,face=&quot;plain&quot;,color=&quot;black&quot;),
    axis.text = element_text(size=12,face=&quot;plain&quot;,color=&quot;black&quot;),
    legend.title=element_text(size=13,face=&quot;plain&quot;,color=&quot;black&quot;),
    legend.position = &quot;right&quot;# c(0.83,0.15)
  )
</code></pre></div></p>
<p><img alt="" src="https://cdn.nlark.com/yuque/0/2020/png/1234840/1609075535635-9ff520fb-d419-465e-8258-46a6bcdad987.png#crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;height=545&amp;id=g7RF6&amp;originHeight=545&amp;originWidth=754&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=0&amp;status=done&amp;style=none&amp;title=&amp;width=754" /></p>
<div class="highlight"><pre><span></span><code>&gt; mydata
        Country Pensions Income Health Other.services
1        France       14      5      9              3
2        Sweden        8      6      7              8
3         Italy       15      4      7              1
4       Germany       11      5      8              3
5         Spain        9      7      7              2
6       Britain        6      6      8              4
7  OECD_average        8      5      6              3
8 United States        7      3      8              1
</code></pre></div>
<h2 id="02"><strong>02.双数据系列柱形图</strong><a class="headerlink" href="#02" title="Permanent link">&para;</a></h2>
<p>mydata的数据格式：
<img alt="" src="https://cdn.nlark.com/yuque/0/2020/png/1234840/1609075535600-14047654-e380-4722-bddd-032b4dc3e2d8.png#crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;height=263&amp;id=b4OJb&amp;originHeight=263&amp;originWidth=1201&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=0&amp;status=done&amp;style=none&amp;title=&amp;width=1201" />
下面是代码
<div class="highlight"><pre><span></span><code>library(reshape2)
mydata &lt;- data.frame(Catergory = c(&quot;Temporary\nStream&quot;,&quot;Permanent\nStream&quot;,&quot;Lake&quot;),
                     year1996 = c(7.67,4.02,3.95),
                     year1997 = c(5.84,6.45,6.76),stringsAsFactors=FALSE)
colnames(mydata) &lt;- c(&quot;Catergory&quot;,&quot;1996&quot;,&quot;1997&quot;)
mydata&lt;-melt(mydata,id.vars=&#39;Catergory&#39;)
# c(&quot;#00AFBB&quot;, &quot;#FC4E07&quot;) 颜色
ggplot(data=mydata,aes(Catergory,value,fill=variable))+
  geom_bar(stat=&quot;identity&quot;,position=position_dodge(),
           color=&quot;black&quot;,width=0.7,size=0.25)+
  scale_fill_manual(values=c(&quot;#A61CE6&quot;, &quot;#E81CA4&quot;))+
  ylim(0, 10)+
  theme(
    axis.title=element_text(size=15,face=&quot;plain&quot;,color=&quot;black&quot;),
    axis.text = element_text(size=12,face=&quot;plain&quot;,color=&quot;black&quot;),
    legend.title=element_text(size=14,face=&quot;plain&quot;,color=&quot;black&quot;),
    legend.background  =element_blank(),
    legend.position = c(0.88,0.88)
  )
</code></pre></div></p>
<p><img alt="" src="https://cdn.nlark.com/yuque/0/2020/png/1234840/1609075535593-ba05e817-99a8-474c-ba9c-49a544d175c1.png#crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;height=558&amp;id=WR9cJ&amp;originHeight=558&amp;originWidth=682&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=0&amp;status=done&amp;style=none&amp;title=&amp;width=682" /></p>
<div class="highlight"><pre><span></span><code>###排序
mydata &lt;- data.frame(Catergory = c(&quot;Temporary\nStream&quot;,&quot;Permanent\nStream&quot;,&quot;Lake&quot;),
                     year1996 = c(7.67,4.02,3.95),
                     year1997 = c(5.84,6.45,6.76),stringsAsFactors=FALSE)
colnames(mydata) &lt;- c(&quot;Catergory&quot;,&quot;1996&quot;,&quot;1997&quot;)
mydata$Catergory&lt;- factor(mydata$Catergory, levels = mydata$Catergory[order(mydata[,&quot;1996&quot;],decreasing = TRUE)])
mydata&lt;-melt(mydata,id.vars=&#39;Catergory&#39;)
ggplot(data=mydata,aes(Catergory,value,fill=variable))+
  geom_bar(stat=&quot;identity&quot;, color=&quot;black&quot;, position=position_dodge(),width=0.7,size=0.25)+
  scale_fill_manual(values=c(&quot;#00AFBB&quot;, &quot;#E7B800&quot;))+
  ylim(0, 10)+
  theme(
    axis.title=element_text(size=15,face=&quot;plain&quot;,color=&quot;black&quot;),
    axis.text = element_text(size=12,face=&quot;plain&quot;,color=&quot;black&quot;),
    legend.title=element_text(size=14,face=&quot;plain&quot;,color=&quot;black&quot;),
    legend.background  =element_blank(),
    legend.position = c(0.88,0.88)
  )
</code></pre></div>
<p><img alt="" src="https://cdn.nlark.com/yuque/0/2020/png/1234840/1609075535633-252cfdad-14e4-4990-9234-7d5c21aa55ab.png#crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;height=678&amp;id=l8vpk&amp;originHeight=678&amp;originWidth=706&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=0&amp;status=done&amp;style=none&amp;title=&amp;width=706" />
横向的柱状图
<div class="highlight"><pre><span></span><code>library(reshape)
mydata&lt;-read.csv(&quot;Stackedbar_Data.csv&quot;,sep=&quot;,&quot;,na.strings=&quot;NA&quot;,stringsAsFactors=FALSE)
mydata&lt;-mydata[,c(1,3,2)]
mydata$Country &lt;- factor(mydata$Country, levels = mydata$Country[order(mydata$Pensions)])
mydata&lt;-melt(mydata,id.vars=&#39;Country&#39;)
ggplot(data=mydata,aes(Country,value,fill=variable))+
  geom_bar(stat=&quot;identity&quot;, color=&quot;black&quot;, position=position_dodge(),width=0.7,size=0.25)+
  scale_fill_manual(values=c(&quot;#B311BF&quot;, &quot;#4411C2&quot;))+
  coord_flip()+
  theme(
    axis.title=element_text(size=15,face=&quot;plain&quot;,color=&quot;black&quot;),
    axis.text = element_text(size=12,face=&quot;plain&quot;,color=&quot;black&quot;),
    legend.title=element_text(size=14,face=&quot;plain&quot;,color=&quot;black&quot;),
    legend.background  =element_blank(),
    legend.position = c(0.83,0.12)
  )
</code></pre></div></p>
<p><img alt="" src="https://cdn.nlark.com/yuque/0/2020/png/1234840/1609075535650-110813b9-e0ae-4645-a9e0-97d6614db1f7.png#crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;height=549&amp;id=RqlAR&amp;originHeight=549&amp;originWidth=780&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=0&amp;status=done&amp;style=none&amp;title=&amp;width=780" /></p>
<h2 id="03"><strong>03.堆积柱形图</strong><a class="headerlink" href="#03" title="Permanent link">&para;</a></h2>
<p>madata数据格式
<img alt="" src="https://cdn.nlark.com/yuque/0/2020/png/1234840/1609075535616-de6628b3-b3d3-4c3d-9421-ae9981c333a7.png#crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;height=483&amp;id=npxWP&amp;originHeight=483&amp;originWidth=1170&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=0&amp;status=done&amp;style=none&amp;title=&amp;width=1170" />
代码：
<div class="highlight"><pre><span></span><code>mydata &lt;- data.frame(Clarity = c(&quot;Fair&quot;,&quot;Good&quot;,&quot;Very_Good&quot;,&quot;Premium&quot;,&quot;Ideal&quot;),
                     I1 = c(150,1200,1300,2800,2000),
                     SI2 =c(400,1100,2300,2900,2700),
                     SI1 = c(390,1700,3300,3500,4200),
                     VS2 = c(300,900,1900,2800,3300),
                     VS1 = c(130,790,1800,3000,4200),
                     S2 = c(100,1300,1900,1800,2700),
                     s1 = c(100,1200,1700,1600,2100),
                     IF = c(150,1100,1300,1280,1300),stringsAsFactors=FALSE)
mydata&lt;-melt(mydata,id.vars=&#39;Clarity&#39;)
ggplot(data=mydata,aes(variable,value,fill=Clarity))+
  geom_bar(stat=&quot;identity&quot;,position=&quot;stack&quot;, color=&quot;black&quot;, width=0.7,size=0.25)+
  scale_fill_manual(values=brewer.pal(9,&quot;YlOrRd&quot;)[c(6:2)])+
  ylim(0, 15000)+
  theme(
    axis.title=element_text(size=15,face=&quot;plain&quot;,color=&quot;black&quot;),
    axis.text = element_text(size=12,face=&quot;plain&quot;,color=&quot;black&quot;),
    legend.title=element_text(size=14,face=&quot;plain&quot;,color=&quot;black&quot;),
    legend.background  =element_blank(),
    legend.position = c(0.85,0.82)
  )
</code></pre></div></p>
<p><img alt="" src="https://cdn.nlark.com/yuque/0/2020/png/1234840/1609075535628-7d2d340d-0e7e-4d29-aeba-2c83bd85d5c2.png#crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;height=556&amp;id=LJs4z&amp;originHeight=556&amp;originWidth=676&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=0&amp;status=done&amp;style=none&amp;title=&amp;width=676" />
<div class="highlight"><pre><span></span><code>###排序
mydata &lt;- data.frame(Clarity = c(&quot;Fair&quot;,&quot;Good&quot;,&quot;Very_Good&quot;,&quot;Premium&quot;,&quot;Ideal&quot;),
                     I1 = c(150,1200,1300,2800,2000),
                     SI2 =c(400,1100,2300,2900,2700),
                     SI1 = c(390,1700,3300,3500,4200),
                     VS2 = c(300,900,1900,2800,3300),
                     VS1 = c(130,790,1800,3000,4200),
                     S2 = c(100,1300,1900,1800,2700),
                     s1 = c(100,1200,1700,1600,2100),
                     IF = c(150,1100,1300,1280,1300),stringsAsFactors=FALSE)
sum&lt;-sort(rowSums(mydata[,2:ncol(mydata)]),index.return=TRUE)
colsum&lt;-sort(colSums(mydata[,2:ncol(mydata)]),index.return=TRUE,decreasing = TRUE)
mydata&lt;-mydata[,c(1,colsum$ix+1)]
mydata$Clarity &lt;- factor(mydata$Clarity, levels = mydata$Clarity[order(sum$ix)])
mydata&lt;-melt(mydata,id.vars=&#39;Clarity&#39;)
ggplot(data=mydata,aes(variable,value,fill=Clarity))+
  geom_bar(stat=&quot;identity&quot;,position=&quot;stack&quot;, color=&quot;black&quot;, width=0.7,size=0.25)+
  scale_fill_manual(values=brewer.pal(9,&quot;YlOrRd&quot;)[c(6:2)])+
  ylim(0, 15000)+
  theme(
    axis.title=element_text(size=15,face=&quot;plain&quot;,color=&quot;black&quot;),
    axis.text = element_text(size=12,face=&quot;plain&quot;,color=&quot;black&quot;),
    legend.title=element_text(size=14,face=&quot;plain&quot;,color=&quot;black&quot;),
    legend.background  =element_blank(),
    legend.position = c(0.85,0.82)
  )
</code></pre></div></p>
<p><img alt="" src="https://cdn.nlark.com/yuque/0/2020/png/1234840/1609075535624-6db7c63b-d5cd-4e7a-ae72-701b895b4eb9.png#crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;height=677&amp;id=pl8ia&amp;originHeight=677&amp;originWidth=700&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=0&amp;status=done&amp;style=none&amp;title=&amp;width=700" /></p>
<div class="highlight"><pre><span></span><code>mydata&lt;-read.csv(&quot;Stackedbar_Data.csv&quot;,sep=&quot;,&quot;,na.strings=&quot;NA&quot;,stringsAsFactors=FALSE)
rowsum&lt;-sort(rowSums(mydata[,2:ncol(mydata)]),index.return=TRUE)
mydata$Country &lt;- factor(mydata$Country, levels = mydata$Country[order(rowsum$ix)])
mydata&lt;-melt(mydata,id.vars=&#39;Country&#39;)
ggplot(data=mydata,aes(Country,value,fill=variable))+
  geom_bar(stat=&quot;identity&quot;,position=&quot;stack&quot;, color=&quot;black&quot;, width=0.65,size=0.25)+
  scale_fill_manual(values=brewer.pal(9,&quot;YlOrRd&quot;)[c(9:5)])+
  ylim(0, 35)+
  coord_flip()+
  theme(
    #text=element_text(size=15,face=&quot;plain&quot;,color=&quot;black&quot;),
    axis.title=element_text(size=15,face=&quot;plain&quot;,color=&quot;black&quot;),
    axis.text = element_text(size=12,face=&quot;plain&quot;,color=&quot;black&quot;),
    legend.title=element_text(size=13,face=&quot;plain&quot;,color=&quot;black&quot;),
    legend.position = &quot;right&quot;# c(0.83,0.15)
  )
</code></pre></div>
<div class="highlight"><pre><span></span><code>&gt; mydata
         Country       variable value
1         France       Pensions    14
2         Sweden       Pensions     8
3          Italy       Pensions    15
4        Germany       Pensions    11
5          Spain       Pensions     9
6        Britain       Pensions     6
7   OECD_average       Pensions     8
8  United States       Pensions     7
9         France         Income     5
10        Sweden         Income     6
11         Italy         Income     4
12       Germany         Income     5
13         Spain         Income     7
14       Britain         Income     6
15  OECD_average         Income     5
16 United States         Income     3
17        France         Health     9
18        Sweden         Health     7
19         Italy         Health     7
20       Germany         Health     8
21         Spain         Health     7
22       Britain         Health     8
23  OECD_average         Health     6
24 United States         Health     8
25        France Other.services     3
26        Sweden Other.services     8
27         Italy Other.services     1
28       Germany Other.services     3
29         Spain Other.services     2
30       Britain Other.services     4
31  OECD_average Other.services     3
32 United States Other.services     1
</code></pre></div>
<p><img alt="" src="https://cdn.nlark.com/yuque/0/2020/png/1234840/1609075535639-fe2ea8fc-58dc-4f4a-bf4e-39a59397dc12.png#crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;height=546&amp;id=goEQa&amp;originHeight=546&amp;originWidth=776&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=0&amp;status=done&amp;style=none&amp;title=&amp;width=776" /></p>
<h2 id="04"><strong>04.百分比堆积柱形图</strong><a class="headerlink" href="#04" title="Permanent link">&para;</a></h2>
<p>数据同堆积柱形图，下面是代码
<div class="highlight"><pre><span></span><code>mydata &lt;- data.frame(Clarity = c(&quot;Fair&quot;,&quot;Good&quot;,&quot;Very_Good&quot;,&quot;Premium&quot;,&quot;Ideal&quot;),
                     I1 = c(150,1200,1300,2800,2000),
                     SI2 =c(400,1100,2300,2900,2700),
                     SI1 = c(390,1700,3300,3500,4200),
                     VS2 = c(300,900,1900,2800,3300),
                     VS1 = c(130,790,1800,3000,4200),
                     S2 = c(100,1300,1900,1800,2700),
                     s1 = c(100,1200,1700,1600,2100),
                     IF = c(150,1100,1300,1280,1300),stringsAsFactors=FALSE)
mydata&lt;-melt(mydata,id.vars=&#39;Clarity&#39;)
ggplot(data=mydata,aes(variable,value,fill=Clarity))+
  geom_bar(stat=&quot;identity&quot;, position=&quot;fill&quot;,color=&quot;black&quot;, width=0.8,size=0.25)+
  scale_fill_manual(values=brewer.pal(9,&quot;GnBu&quot;)[c(7:2)])+
  theme(
    axis.title=element_text(size=15,face=&quot;plain&quot;,color=&quot;black&quot;),
    axis.text = element_text(size=12,face=&quot;plain&quot;,color=&quot;black&quot;),
    legend.title=element_text(size=14,face=&quot;plain&quot;,color=&quot;black&quot;),
    legend.position = &quot;right&quot;
  )
</code></pre></div></p>
<p><img alt="" src="https://cdn.nlark.com/yuque/0/2020/png/1234840/1609075535642-e532af87-53fd-491a-93ac-87d6de011a5a.png#crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;height=488&amp;id=mAtl6&amp;originHeight=557&amp;originWidth=730&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=0&amp;status=done&amp;style=none&amp;title=&amp;width=639" /></p>
<div class="highlight"><pre><span></span><code>#排序
mydata &lt;- data.frame(Clarity = c(&quot;Fair&quot;,&quot;Good&quot;,&quot;Very_Good&quot;,&quot;Premium&quot;,&quot;Ideal&quot;),
                     I1 = c(150,1200,1300,2800,2000),
                     SI2 =c(400,1100,2300,2900,2700),
                     SI1 = c(390,1700,3300,3500,4200),
                     VS2 = c(300,900,1900,2800,3300),
                     VS1 = c(130,790,1800,3000,4200),
                     S2 = c(100,1300,1900,1800,2700),
                     s1 = c(100,1200,1700,1600,2100),
                     IF = c(150,1100,1300,1280,1300),stringsAsFactors=FALSE)
Per&lt;-(as.matrix(mydata[5,2:ncol(mydata)])) / t(as.matrix(colSums(mydata[,2:ncol(mydata)]))) 
Ideal&lt;-sort(as.numeric(Per),index.return=TRUE,decreasing = TRUE) 
mydata&lt;-mydata[,c(1,Ideal$ix+1)] 
mydata$Clarity &lt;- factor(mydata$Clarity, levels = mydata$Clarity[c(1:5)]) 
mydata&lt;-melt(mydata,id.vars=&#39;Clarity&#39;) 
ggplot(data=mydata,aes(variable,value,fill=Clarity))+ 
  geom_bar(stat=&quot;identity&quot;, position=&quot;fill&quot;,color=&quot;black&quot;, width=0.8,size=0.25)+
  scale_fill_manual(values=brewer.pal(9,&quot;GnBu&quot;)[c(7:2)])+
  theme(
    axis.title=element_text(size=15,face=&quot;plain&quot;,color=&quot;black&quot;),
    axis.text = element_text(size=12,face=&quot;plain&quot;,color=&quot;black&quot;),
    legend.title=element_text(size=14,face=&quot;plain&quot;,color=&quot;black&quot;),
    legend.position = &quot;right&quot;
  )
</code></pre></div>
<p><img alt="" src="https://cdn.nlark.com/yuque/0/2020/png/1234840/1609075535676-0503c7f2-3162-4ad6-9a9f-2a1bb6805b14.png#crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;height=576&amp;id=M3dn4&amp;originHeight=676&amp;originWidth=754&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=0&amp;status=done&amp;style=none&amp;title=&amp;width=642" />
横向：
<div class="highlight"><pre><span></span><code>mydata&lt;-read.csv(&quot;Stackedbar_Data.csv&quot;,sep=&quot;,&quot;,na.strings=&quot;NA&quot;,stringsAsFactors=FALSE)
sum&lt;-sort(rowSums(mydata[,2:ncol(mydata)]),index.return=TRUE)
mydata$Country &lt;- factor(mydata$Country, levels = mydata$Country[order(sum$ix)])
mydata&lt;-melt(mydata,id.vars=&#39;Country&#39;)
library(RColorBrewer)
ggplot(data=mydata,aes(Country,value,fill=variable))+
  geom_bar(stat=&quot;identity&quot;,position=&quot;fill&quot;, color=&quot;black&quot;, width=0.65,size=0.25)+
  scale_fill_manual(values=brewer.pal(9,&quot;Greens&quot;)[c(9:5)])+
  coord_flip()+
  theme(
    axis.title=element_text(size=15,face=&quot;plain&quot;,color=&quot;black&quot;),
    axis.text = element_text(size=12,face=&quot;plain&quot;,color=&quot;black&quot;),
    legend.title=element_text(size=13,face=&quot;plain&quot;,color=&quot;black&quot;),
    legend.position = &quot;right&quot;
  )
</code></pre></div></p>
<p><img alt="" src="https://cdn.nlark.com/yuque/0/2020/png/1234840/1609075535674-85998265-d5ee-4b9c-a37d-cac4d98653aa.png#crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;height=544&amp;id=cW4B7&amp;originHeight=544&amp;originWidth=772&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=0&amp;status=done&amp;style=none&amp;title=&amp;width=772" /></p>
<div class="highlight"><pre><span></span><code>&gt; mydata
         Country       variable value
1         France       Pensions    14
2         Sweden       Pensions     8
3          Italy       Pensions    15
4        Germany       Pensions    11
5          Spain       Pensions     9
6        Britain       Pensions     6
7   OECD_average       Pensions     8
8  United States       Pensions     7
9         France         Income     5
10        Sweden         Income     6
11         Italy         Income     4
12       Germany         Income     5
13         Spain         Income     7
14       Britain         Income     6
15  OECD_average         Income     5
16 United States         Income     3
17        France         Health     9
18        Sweden         Health     7
19         Italy         Health     7
20       Germany         Health     8
21         Spain         Health     7
22       Britain         Health     8
23  OECD_average         Health     6
24 United States         Health     8
25        France Other.services     3
26        Sweden Other.services     8
27         Italy Other.services     1
28       Germany Other.services     3
29         Spain Other.services     2
30       Britain Other.services     4
31  OECD_average Other.services     3
32 United States Other.services     1
</code></pre></div>
<h2 id="05"><strong>05.不等宽柱形图</strong><a class="headerlink" href="#05" title="Permanent link">&para;</a></h2>
<p>geom_rect()函数可以根据右下角坐标(xmin,ymin)和左上角坐标(xmax,ymax)绘制矩形，矩形宽度(width)为max~xmin对应X轴变量的数值大小矩形的高度(height)为ymax~ymin对应Y轴的数值大小。
<div class="highlight"><pre><span></span><code>##不等宽柱形图
library(ggplot2)
#install.packages(&quot;Cairo&quot;)
library(Cairo)
#install.packages(&quot;showtext&quot;)
library(showtext)
mydata&lt;-data.frame(Name=paste0(&quot;Project&quot;,1:5),Scale=c(35,30,20,10,5),ARPU=c(56,37,63,57,59))
mydata$xmin&lt;-0
for (i in 2:5){
  mydata$xmin[i]&lt;-sum(mydata$Scale[1:i-1])
}
#构造矩形X轴的终点（最大点）
for (i in 1:5){
  mydata$xmax[i]&lt;-sum(mydata$Scale[1:i])
}
#构造数据标签的横坐标：
for (i in 1:5){
  mydata$label[i]&lt;-sum(mydata$Scale[1:i])-mydata$Scale[i]/2
}
#CairoPDF(file=&quot;不等宽柱形图.pdf&quot;,width=4.89,height=5.53)
#showtext.begin()
#windowsFonts(myFont = windowsFont(&quot;微软雅黑&quot;))
ggplot(mydata)+
  geom_rect(aes(xmin=xmin,xmax=xmax,ymin=0,ymax=ARPU,fill=Name),colour=&quot;black&quot;,size=0.25)+
  geom_text(aes(x=label,y=ARPU+3,label=ARPU),size=4,col=&quot;black&quot;)+
  geom_text(aes(x=label,y=-2.5,label=Name),size=4,col=&quot;black&quot;)+
  ylab(&quot;ARPU&quot;)+
  xlab(&quot;scale&quot;)+
  ylim(-5,80)+
  theme(panel.background=element_rect(fill=&quot;white&quot;,colour=NA),
        panel.grid.major = element_line(colour = &quot;grey60&quot;,size=.25,linetype =&quot;dotted&quot; ),
        panel.grid.minor = element_line(colour = &quot;grey60&quot;,size=.25,linetype =&quot;dotted&quot; ),
        text=element_text(size=15),
        plot.title=element_text(size=15,hjust=.5),#family=&quot;myfont&quot;,
        legend.position=&quot;none&quot;
  )
#showtext.end()
#dev.off()
</code></pre></div></p>
<p><img alt="" src="https://cdn.nlark.com/yuque/0/2020/png/1234840/1609075535661-c3d23b51-7333-4e8f-84cd-e991520fbb2d.png#crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;height=740&amp;id=NToZt&amp;originHeight=811&amp;originWidth=1403&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=0&amp;status=done&amp;style=none&amp;title=&amp;width=1280" /></p>
<h2 id="06"><strong>06.棒棒糖图</strong><a class="headerlink" href="#06" title="Permanent link">&para;</a></h2>
<p>就是一根柱子加上一个圆，其实类似传统的柱状图。但是它可以给我们更多的信息，因为圆和下面的棒子可以代表同一组数据，也可以代表两组数据。“糖”和“棒子”的颜色也一样，可以表示同一个信息也可以表示不同维度的信息。</p>
<div class="highlight"><pre><span></span><code>library(ggplot2)
library(reshape2)
#-------------------------------- (a)棒棒糖图 ----------------------------------------------
mydata&lt;-read.csv(&quot;DotPlots_Data.csv&quot;,sep=&quot;,&quot;,na.strings=&quot;NA&quot;,stringsAsFactors=FALSE)
mydata$sum&lt;-rowSums(mydata[,2:3])
order&lt;-sort(mydata$sum,index.return=TRUE,decreasing = FALSE)
mydata$City&lt;- factor(mydata$City, levels = mydata$City[order$ix])
ggplot(mydata, aes(sum, City)) +
  geom_segment(aes(x=0, 
                   xend=sum,
                   y=City, 
                   yend=City))+
  geom_point(shape=21,size=3,colour=&quot;black&quot;,fill=&quot;#FC4E07&quot;)+
  theme(
    axis.title=element_text(size=13,face=&quot;plain&quot;,color=&quot;black&quot;),
    axis.text = element_text(size=10,face=&quot;plain&quot;,color=&quot;black&quot;),
    legend.title=element_text(size=14,face=&quot;plain&quot;,color=&quot;black&quot;)
  )
</code></pre></div>
<p><img alt="" src="https://cdn.nlark.com/yuque/0/2020/png/1234840/1609075535681-a145be37-d1d1-4dbc-892e-0d1fad988362.png#crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;height=810&amp;id=kTqgg&amp;originHeight=810&amp;originWidth=751&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=0&amp;status=done&amp;style=none&amp;title=&amp;width=751" />
绘制棒棒糖图，有一个专门的包ggpubr
<div class="highlight"><pre><span></span><code>data(&quot;mtcars&quot;)
dfm &lt;- mtcars
# 转为factor类型的数据
dfm$cyl &lt;- as.factor(dfm$cyl)# 增加一列name
dfm$name &lt;- rownames(dfm)
library(ggpubr)
ggdotchart(dfm, x = &quot;name&quot;, y = &quot;mpg&quot;,
           color = &quot;cyl&quot;,                                # 按照cyl填充颜色
           palette = c(&quot;#00AFBB&quot;, &quot;#E7B800&quot;, &quot;#FC4E07&quot;), # 修改颜色
           sorting = &quot;ascending&quot;,                        
           add = &quot;segments&quot;,                             # 添加棒子
           ggtheme = theme_pubr(),                        # 改变主题
           xlab=&quot;&quot;
)
</code></pre></div></p>
<p><img alt="" src="https://cdn.nlark.com/yuque/0/2020/png/1234840/1609075535655-1eed1169-dcd4-4fc6-adbc-8a7e7001de39.png#crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;height=567&amp;id=B9GmP&amp;originHeight=567&amp;originWidth=746&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=0&amp;status=done&amp;style=none&amp;title=&amp;width=746" /></p>
<div class="highlight"><pre><span></span><code>ggdotchart(dfm, x = &quot;name&quot;, y = &quot;mpg&quot;,
           color = &quot;cyl&quot;,                                # 按照cyl填充颜色
           palette = c(&quot;#00AFBB&quot;, &quot;#E7B800&quot;, &quot;#FC4E07&quot;), # 修改颜色
           sorting = &quot;descending&quot;,                      
           add = &quot;segments&quot;,                             # 添加棒子
           add.params = list(color = &quot;lightgray&quot;, size = 1.5),#改变棒子参数
           rotate = TRUE,                                # 方向转为垂直
           group = &quot;cyl&quot;,                                
           dot.size = 6,                                 # 改变点的大小
           label = round(dfm$mpg),                       # 添加label
           font.label = list(color = &quot;white&quot;, size = 9, 
                             vjust = 0.5),               # 设置label参数
           ggtheme = theme_pubr(),                        # 改变主题
           xlab=&quot;&quot;)
</code></pre></div>
<p><img alt="" src="https://cdn.nlark.com/yuque/0/2020/png/1234840/1609075535643-60a5363b-9547-4fa6-8d7e-262c444824d5.png#crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;height=814&amp;id=Lb4vf&amp;originHeight=814&amp;originWidth=742&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=0&amp;status=done&amp;style=none&amp;title=&amp;width=742" /></p>
<h2 id="07"><strong>07.克里兰夫点图</strong><a class="headerlink" href="#07" title="Permanent link">&para;</a></h2>
<p>克利夫兰点图（Cleveland'sDot Plots）：也就是我们常用的滑珠散点图，非常类似于棒棒糖图，只是没有连接的线条，重点强调数据的排序展示以及互相之间的差距。克利夫兰点图一般都是横向展示，所以Y轴变量一般为类别型变量。
<div class="highlight"><pre><span></span><code>###克里兰夫点图
mydata&lt;-read.csv(&quot;DotPlots_Data.csv&quot;,sep=&quot;,&quot;,na.strings=&quot;NA&quot;,stringsAsFactors=FALSE)
mydata$sum&lt;-rowSums(mydata[,2:3])
order&lt;-sort(mydata$sum,index.return=TRUE,decreasing = FALSE)
mydata$City&lt;- factor(mydata$City, levels = mydata$City[order$ix])
ggplot(mydata, aes(sum, City)) +
  geom_point(shape=21,size=3,colour=&quot;black&quot;,fill=&quot;#FC4E07&quot;)+
  theme(
    axis.title=element_text(size=13,face=&quot;plain&quot;,color=&quot;black&quot;),
    axis.text = element_text(size=10,face=&quot;plain&quot;,color=&quot;black&quot;),
    legend.title=element_text(size=14,face=&quot;plain&quot;,color=&quot;black&quot;)
  )
</code></pre></div></p>
<p><img alt="" src="https://cdn.nlark.com/yuque/0/2020/png/1234840/1609075535739-ba47c921-17e8-44ef-9dd4-d474b1478e14.png#crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;height=445&amp;id=iylNU&amp;originHeight=445&amp;originWidth=751&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=0&amp;status=done&amp;style=none&amp;title=&amp;width=751" /></p>
<h2 id="08dumbbellplot"><strong>08.哑铃图（DumbbellPlot）</strong><a class="headerlink" href="#08dumbbellplot" title="Permanent link">&para;</a></h2>
<p>可以看成多数据系列的克利夫兰点图，只是使用直线连接了两个数据系列的数据点。哑铃图可以主要用于：1.展示在同一时间段两个数据点的相对位置（增加或者减少），2.比较两个类别之间的数据值差别。如图所示，就是展示了男性（male）和女性（Female）两个类别的数值差别，以女性（Female）数据系列的数值排序显示。
<div class="highlight"><pre><span></span><code>mydata&lt;-read.csv(&quot;DotPlots_Data.csv&quot;,sep=&quot;,&quot;,na.strings=&quot;NA&quot;,stringsAsFactors=FALSE)
mydata$City &lt;- factor(mydata$City, levels = mydata$City[order(mydata$Female)])
mydata&lt;-melt(mydata,id.vars=&#39;City&#39;)
ggplot(mydata, aes(value,City,fill=variable)) +
  geom_line(aes(group = City)) +
  geom_point(shape=21,size=3,colour=&quot;black&quot;)+
  scale_fill_manual(values=c(&quot;#00AFBB&quot;, &quot;#FC4E07&quot;,&quot;#36BED9&quot;))+
  theme(
    axis.title=element_text(size=13,face=&quot;plain&quot;,color=&quot;black&quot;),
    axis.text = element_text(size=10,face=&quot;plain&quot;,color=&quot;black&quot;),
    legend.title=element_text(size=12,face=&quot;plain&quot;,color=&quot;black&quot;),
    legend.background = element_blank(),
    legend.position = c(0.85,0.12)
  )
</code></pre></div></p>
<p><img alt="" src="https://cdn.nlark.com/yuque/0/2020/png/1234840/1609075535746-0c25a83e-bb73-431f-aa44-e6197c186091.png#crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;height=584&amp;id=YOQxB&amp;originHeight=584&amp;originWidth=534&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=0&amp;status=done&amp;style=none&amp;title=&amp;width=534" /></p>
<h2 id="09"><strong>09.坡度图</strong><a class="headerlink" href="#09" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code>library(ggplot2)
library(scales)
library(reshape)
#--------------------------------------(a)两年份对比---------------------------------------------------------------
df &lt;- read.csv(&quot;Slopecharts_Data1.csv&quot;)
colnames(df) &lt;- c(&quot;continent&quot;, &quot;1952&quot;, &quot;1957&quot;)
left_label &lt;- paste(df$continent, round(df$`1952`),sep=&quot;, &quot;)
right_label &lt;- paste(df$continent, round(df$`1957`),sep=&quot;, &quot;)
df$class &lt;- ifelse((df$`1957` - df$`1952`) &lt; 0, &quot;red&quot;, &quot;green&quot;)
p &lt;- ggplot(df) + 
  geom_segment(aes(x=1, xend=2, y=`1952`, yend=`1957`, col=class), size=.75, show.legend=F) +  #连接线
  geom_vline(xintercept=1, linetype=&quot;solid&quot;, size=.1) + # 1952年的垂直直线
  geom_vline(xintercept=2, linetype=&quot;solid&quot;, size=.1) + # 1957年的垂直直线
  geom_point(aes(x=1, y=`1952`), size=3,shape=21,fill=&quot;grey80&quot;,color=&quot;black&quot;) + # 1952年的数据点
  geom_point(aes(x=2, y=`1957`), size=3,shape=21,fill=&quot;grey80&quot;,color=&quot;black&quot;) + # 1957年的数据点
  scale_color_manual(labels = c(&quot;Up&quot;, &quot;Down&quot;), values = c(&quot;green&quot;=&quot;#A6D854&quot;,&quot;red&quot;=&quot;#FC4E07&quot;)) +  
  xlim(.5, 2.5) 
# 添加文本信息
p &lt;- p + geom_text(label=left_label, y=df$`1952`, x=rep(1, NROW(df)), hjust=1.1, size=3.5)
p &lt;- p + geom_text(label=right_label, y=df$`1957`, x=rep(2, NROW(df)), hjust=-0.1, size=3.5)
p &lt;- p + geom_text(label=&quot;1952&quot;, x=1, y=1.02*(max(df$`1952`, df$`1957`)), hjust=1.2, size=5)   
p &lt;- p + geom_text(label=&quot;1957&quot;, x=2, y=1.02*(max(df$`1952`, df$`1957`)), hjust=-0.1, size=5) 
p&lt;-p+theme_void()
p
</code></pre></div>
<p><img alt="" src="https://cdn.nlark.com/yuque/0/2020/png/1234840/1609075535691-8c912d85-9388-490f-91eb-c41d9b87c834.png#crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;height=763&amp;id=y1e1l&amp;originHeight=763&amp;originWidth=722&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=0&amp;status=done&amp;style=none&amp;title=&amp;width=722" /></p>
<div class="highlight"><pre><span></span><code>install.packages(&quot;ggalt&quot;)
library(ggalt)
df &lt;- read.csv(&quot;Slopecharts_Data2.csv&quot;)
colnames(df) &lt;- c(&quot;continent&quot;, 2007:2013)
df2&lt;-melt(df, id=&quot;continent&quot;)
df2$value&lt;-as.numeric(df2$value)
df2$variable&lt;-as.numeric(df2$variable)
left_label&lt;-paste(df2$continent,  round(df2$value),sep=&quot;, &quot;)
right_label&lt;-paste(df2$continent, round(df2$value),sep=&quot;, &quot;)
left_point&lt;-df2$value
right_point&lt;-df2$value
class&lt;-df2$variable
for (i in 1:nrow(df2))
{
  if (df2$variable[i]!=1)
  {
    left_label[i]&lt;-&quot;&quot;
    left_point[i]&lt;-NaN
  }
  if (df2$variable[i]!=7)
  {
    right_label[i]&lt;-&quot;&quot;
    right_point[i]&lt;-NaN
  }

  if (df[df$continent==df2$continent[i],2]&gt;df[df$continent==df2$continent[i],8])
  {
    class[i]&lt;-&quot;green&quot;
  }
  else
  {
    class[i]&lt;-&quot;red&quot;
  }

}
p &lt;- ggplot(df2) + 
  geom_xspline(aes(x=variable, y=value,group=continent, colour=class),size=.75) + 
  geom_vline(xintercept=1, linetype=&quot;solid&quot;, size=.1) + 
  geom_vline(xintercept=7, linetype=&quot;solid&quot;, size=.1) +
  geom_point(aes(x=variable, y=left_point), size=3,shape=21,fill=&quot;grey80&quot;,color=&quot;black&quot;) + 
  geom_point(aes(x=variable, y=right_point), size=3,shape=21,fill=&quot;grey80&quot;,color=&quot;black&quot;) + 
  scale_color_manual(labels = c(&quot;Up&quot;, &quot;Down&quot;), values = c(&quot;green&quot;=&quot;#FC4E07&quot;,  &quot;red&quot;=&quot;#A6D854&quot;)) +  
  xlim(-4, 12) 
p &lt;- p + geom_text(label=left_label, y=df2$value, x=rep(1, NROW(df2)), hjust=1.1, size=3.5)
p &lt;- p + geom_text(label=right_label, y=df2$value, x=rep(7, NROW(df2)), hjust=-0.1, size=3.5)
p &lt;- p + geom_text(label=&quot;2007&quot;, x=1, y=1.02*(max(df2$value)), hjust=1.2, size=5)  # title
p &lt;- p + geom_text(label=&quot;2013&quot;, x=7, y=1.02*(max(df2$value)), hjust=-0.1, size=5)  # title
p&lt;-p+theme_void()+
  theme(legend.position = &quot;none&quot;)
p
</code></pre></div>
<p><img alt="" src="https://cdn.nlark.com/yuque/0/2020/png/1234840/1609075535673-38724fda-11f4-4735-bc7a-05e3c021fcfb.png#crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;height=700&amp;id=t8yZb&amp;originHeight=700&amp;originWidth=539&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=0&amp;status=done&amp;style=none&amp;title=&amp;width=539" /></p>
<h2 id="10_1"><strong>10.南丁格尔玫瑰图</strong><a class="headerlink" href="#10_1" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code>library(ggplot2)
#----------------------------------单数据系列极坐标柱形图-----------------------------------------
mydata &lt;- data.frame( a=c(&quot;Monday&quot;,&quot;Tuesday&quot;,&quot;Wednesday&quot;,&quot;Thursday&quot;,&quot;Friday&quot;,&quot;Saturday&quot;,&quot;Sunday&quot;),
                      b=c(50, 60, 70, 20,90,110,30))
myAngle &lt;-seq(-20,-340,length.out =7)
ggplot(mydata) +
  geom_bar(aes(x=a, y=b),width = 1,stat=&quot;identity&quot;,
           colour = &quot;black&quot;,fill=&quot;#F8766D&quot;) +
  geom_text(aes(x=a,y = b-8,label = b),color=&quot;white&quot;) +
  coord_polar(theta = &quot;x&quot;,start=0) +
  ylim(c(0,120))+
  theme_light()+
  theme( panel.background = element_blank(),
         panel.grid.major = element_line(colour = &quot;grey80&quot;,size=.25),
         axis.text.y = element_text(size = 12,colour=&quot;black&quot;),
         axis.line.y = element_line(size=0.25),
         axis.text.x=element_text(size = 13,colour=&quot;black&quot;,angle = myAngle))
</code></pre></div>
<p><img alt="" src="https://cdn.nlark.com/yuque/0/2020/png/1234840/1609075535714-929dcf88-9c25-4902-bdaf-eb9a1371e445.png#crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;height=551&amp;id=KmOSQ&amp;originHeight=551&amp;originWidth=579&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=0&amp;status=done&amp;style=none&amp;title=&amp;width=579" /></p>
<div class="highlight"><pre><span></span><code>#--------------------------------多数据系列极坐标柱形图-------------------------------------------
diamonds&lt;-cbind(diamonds,Cou=rep(1,nrow(diamonds)))
sum_clarity&lt;-aggregate(Cou~clarity,diamonds,sum)
sort_clarity&lt;-arrange(sum_clarity,desc(Cou))
diamonds$clarity&lt;- factor(diamonds$clarity, levels = sort_clarity$clarity)
myAngle &lt;-seq(-20,-340,length.out = 8)
ggplot(diamonds,aes(x=clarity,fill=color))+
  geom_bar(width=1.0,colour=&quot;black&quot;,size=0.25)+
  coord_polar(theta = &quot;x&quot;,start=0)+
  scale_fill_brewer(palette=&quot;GnBu&quot;)+
  guides(fill=guide_legend(reverse=TRUE,title=NULL))+
  ylim(c(0,12000))+
  theme_light()+
  theme( panel.background = element_blank(),
         panel.grid.major = element_line(colour = &quot;grey80&quot;,size=.25),
         axis.text.y = element_text(size = 12,colour=&quot;black&quot;),
         axis.line.y = element_line(size=0.25),
         axis.text.x=element_text(size = 13,colour=&quot;black&quot;,angle = myAngle))
ggplot(diamonds,aes(x=clarity,fill=color))+
  geom_bar(width=1.0,colour=&quot;black&quot;,size=0.25)+
  coord_polar(theta = &quot;x&quot;,start=0)+
  scale_fill_brewer(palette=&quot;Reds&quot;)+
  guides(fill=guide_legend(reverse=TRUE,title=&quot;Color&quot;))+
  ylim(c(-2000,12000))+
  theme_light()+
  theme( panel.background = element_blank(),
         panel.grid.major = element_line(colour = &quot;grey80&quot;,size=.25),
         axis.text.y = element_text(size = 12,colour=&quot;black&quot;),
         axis.line.y = element_line(size=0.25),
         axis.text.x=element_text(size = 13,colour=&quot;black&quot;,angle = myAngle))
</code></pre></div>
<p><img alt="" src="https://cdn.nlark.com/yuque/0/2020/png/1234840/1609075535704-418d2efa-c17e-460f-9c0c-9973a9aa46ab.png#crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;height=550&amp;id=hrr0v&amp;originHeight=550&amp;originWidth=692&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=0&amp;status=done&amp;style=none&amp;title=&amp;width=692" /></p>
<h2 id="11"><strong>11.径向柱形图</strong><a class="headerlink" href="#11" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code>library(ggplot2)
library(RColorBrewer)
df &lt;- data.frame(item=rep(LETTERS[1:10], 5), 
                 score=rep(letters[1:5], each=10), 
                 value=rep((1:5), each=10) + rnorm(50, 0, .5))
myAng &lt;-seq(-20,-340,length.out =10)
ggplot(data=df,aes(item,value,fill=score))+
  geom_bar(stat=&quot;identity&quot;, color=&quot;black&quot;, position=position_dodge(),width=0.7,size=0.25)+
  coord_polar(theta = &quot;x&quot;,start=0) +
  ylim(c(-3,6))+
  scale_fill_brewer(palette=&quot;YlGnBu&quot;)+
  theme_light()+
  theme( panel.background = element_blank(),
         panel.grid.major = element_line(colour = &quot;grey80&quot;,size=.25),
         axis.text.y = element_text(size = 12,colour=&quot;black&quot;),
         axis.line.y = element_line(size=0.25),
         axis.text.x=element_text(size = 13,colour=&quot;black&quot;,angle = myAng))
</code></pre></div>
<p><img alt="" src="https://cdn.nlark.com/yuque/0/2020/png/1234840/1609075535656-c06ed9c1-f938-4fc7-91c2-07d9888887e0.png#crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;height=548&amp;id=lw1XH&amp;originHeight=548&amp;originWidth=646&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=0&amp;status=done&amp;style=none&amp;title=&amp;width=646" />
12.雷达图</p>
<div class="highlight"><pre><span></span><code>library(ggplot2)
#--------------------------------------------雷达图实现原理-------------------------------------------------------
#Reference:https://github.com/cardiomoon/ggplot2new/blob/4e50b7dcfee3246a169702f88f7dd46cbf933f4b/coord_radar.R
coord_radar &lt;- function (theta = &quot;x&quot;, start = 0, direction = 1) 
{  theta &lt;- match.arg(theta, c(&quot;x&quot;, &quot;y&quot;))
r &lt;- if (theta == &quot;x&quot;) 
  &quot;y&quot;
else &quot;x&quot;
ggproto(&quot;CoordRadar&quot;, CoordPolar, theta = theta, r = r, start = start, 
        direction = sign(direction),
        is_linear = function(coord) TRUE)}
#----------------------------------------单数据系列--------------------------------------------------------------
label_data&lt;-data.frame(car=c(&quot;Math&quot; , &quot;English&quot; , &quot;Biology&quot; , &quot;Music&quot; , &quot;R-Coding&quot; ),
                       id=c(1:5) ,
                       value=c(12 , 2 ,14 ,20, 18))
AddRow&lt;-c(NA,nrow(label_data)+1,label_data[1,ncol(label_data)])
mydata&lt;-rbind(label_data,AddRow)
myAngle&lt;- 360- 360 * (label_data$id-1) /nrow(label_data)  
ggplot() + 
  geom_polygon(data=mydata,aes(x=id, y=value),color = &quot;black&quot;, fill=brewer.pal(7,&quot;Set1&quot;)[1],alpha=0.1)+
  geom_point(data=mydata,aes(x=id, y=value),size=5,shape=21,color = &#39;black&#39;, fill=brewer.pal(7,&quot;Set1&quot;)[1])+
  coord_polar() + #实现为图3-8-1(c) 的圆形雷达图
  ylim(0,22)+
  theme_light()+
  theme(axis.text.x=element_text(size = 11,colour=&quot;black&quot;))
ggplot() + 
  geom_polygon(data=mydata,aes(x=id, y=value),color = &quot;black&quot;, fill=brewer.pal(7,&quot;Set1&quot;)[1],alpha=0.1)+
  geom_point(data=mydata,aes(x=id, y=value),size=5,shape=21,color = &#39;black&#39;, fill=brewer.pal(7,&quot;Set1&quot;)[1])+
  coord_polar() + #实现为图3-8-1(c) 的圆形雷达图
  #coord_radar()+  #
  scale_x_continuous(breaks =label_data$id,labels=label_data$car)+
  ylim(0,22)+
  theme_light()+
  theme(axis.text.x=element_text(size = 11,colour=&quot;black&quot;,angle = myAngle))
</code></pre></div>
<p><img alt="" src="https://cdn.nlark.com/yuque/0/2020/png/1234840/1609075535703-a669ed80-15bc-4533-ad1f-0ae5c9ef6ea4.png#crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;height=546&amp;id=CD0Hs&amp;originHeight=546&amp;originWidth=584&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=0&amp;status=done&amp;style=none&amp;title=&amp;width=584" />
<div class="highlight"><pre><span></span><code>###---------------多序列数据雷达图
coord_radar &lt;- function (theta = &quot;x&quot;, start = 0, direction = 1) 
{  theta &lt;- match.arg(theta, c(&quot;x&quot;, &quot;y&quot;))
r &lt;- if (theta == &quot;x&quot;) 
  &quot;y&quot;
else &quot;x&quot;
ggproto(&quot;CoordRadar&quot;, CoordPolar, theta = theta, r = r, start = start, 
        direction = sign(direction),
        is_linear = function(coord) TRUE)}
#--------------------------------------------多数据系列-------------------------------------------------------
label_data&lt;-data.frame(
  car=c(&quot;biology&quot; , &quot;english&quot; ,&quot;math&quot; ,  &quot;music&quot; , &quot;R-coding&quot; ),
  id=c(1:5) ,
  v1=sample( 0:20,5, replace=T),
  v2=sample( 0:20,5, replace=T)
)
AddRow&lt;-c(NA,nrow(label_data)+1,label_data[1,ncol(label_data)-1],label_data[1,ncol(label_data)])
mydata&lt;-rbind(label_data,AddRow)
myAngle&lt;- 360- 360 * (label_data$id-1) /nrow(label_data)  
mydata&lt;-melt(mydata,id=c(&quot;car&quot;, &quot;id&quot;))
ggplot(data=mydata,aes(x=id, y=value,group=variable,fill=variable)) + 
  geom_polygon(colour=&quot;black&quot;,alpha=0.1)+
  geom_point(size=4,shape=21,color = &#39;black&#39;)+
  coord_radar()+
  #coord_polar() +
  scale_x_continuous(breaks =label_data$id,labels=label_data$car)+
  theme_bw() +
  ylim(0,22)+
  theme(axis.text.x=element_text(size = 11,colour=&quot;black&quot;,angle = myAngle),
        axis.title=element_text(size=15,face=&quot;plain&quot;,color=&quot;black&quot;),
        axis.text = element_text(size=12,face=&quot;plain&quot;,color=&quot;black&quot;),
        panel.grid.major = element_line(color=&quot;grey80&quot;),
        axis.line = element_line(color=&quot;black&quot;),
        axis.ticks =  element_line(color=&quot;black&quot;))
</code></pre></div></p>
<p><img alt="" src="https://cdn.nlark.com/yuque/0/2020/png/1234840/1609075535711-8cc89dcd-6a16-49bb-aad7-05858fd32189.png#crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;height=541&amp;id=M3qRN&amp;originHeight=541&amp;originWidth=675&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=0&amp;status=done&amp;style=none&amp;title=&amp;width=675" /></p>
<h2 id="12"><strong>12.词云图</strong><a class="headerlink" href="#12" title="Permanent link">&para;</a></h2>
<p>代码有错误
<div class="highlight"><pre><span></span><code>#install.packages(&quot;tm&quot;)
#install.packages(&quot;wordcloud&quot;)
library(tm)
library(wordcloud)
Paper1&lt;-paste(scan(&quot;Paper1.txt&quot;, what = character(0),sep = &quot;&quot;), collapse = &quot; &quot;)  
Paper2&lt;-paste(scan(&quot;Paper2.txt&quot;, what = character(0),sep = &quot;&quot;), collapse = &quot; &quot;)  
tmpText&lt;- data.frame(c(Paper1, Paper2),row.names=c(&quot;Text1&quot;,&quot;Text2&quot;))
df_title &lt;- data.frame(doc_id=row.names(tmpText),
                       text=tmpText$c.Paper1..Paper2.)
ds &lt;- DataframeSource(df_title)
corp = Corpus(ds)
corp = tm_map(corp,removePunctuation)
corp = tm_map(corp,PlainTextDocument)
corp = tm_map(corp,removeNumbers)
corp = tm_map(corp, function(x){removeWords(x,stopwords())})
term.matrix &lt;- TermDocumentMatrix(corp)
term.matrix &lt;- as.matrix(term.matrix)
colnames(term.matrix) &lt;- c(&quot;Paper1&quot;,&quot;paper2&quot;)
#------------------------------------------------------------------------------------------------------
comparison.cloud(term.matrix, max.words=300, random.order=FALSE, rot.per=.15, c(4,0.4), title.size=1.4)
comparison.cloud(term.matrix,max.words=300,random.order=FALSE,colors=c(&quot;#00B2FF&quot;, &quot;red&quot;))
commonality.cloud(term.matrix,max.words=100,random.order=FALSE,color=&quot;#E7298A&quot;)
# comparison cloud
comparison.cloud(term.matrix, random.order=FALSE, 
                 colors = c(&quot;#00B2FF&quot;, &quot;red&quot;, &quot;#FF0099&quot;, &quot;#6600CC&quot;),
                 title.size=1.5, max.words=500)
#------------------------------------------------------------------------------------------------------
df&lt;-data.frame(term.matrix)
#Colors&lt;-colorRampPalette(rev(brewer.pal(9,&#39;RdBu&#39;)))(length(df$Paper1&gt;10))
wordcloud(row.names(df) , df$Paper1 , min.freq=10,col=brewer.pal(8, &quot;Dark2&quot;), rot.per=0.3 )
</code></pre></div></p>
<h1 id="_3"><strong>五.箱型图</strong><a class="headerlink" href="#_3" title="Permanent link">&para;</a></h1>
<div class="highlight"><pre><span></span><code>&gt; head(InsectSprays)
  count spray
1    10     A
2     7     A
3    20     A
4    14     A
5    14     A
6    12     A
</code></pre></div>
<div class="highlight"><pre><span></span><code>boxplot(count ~ spray, data = InsectSprays, col = &quot;lightgray&quot;)
</code></pre></div>
<p><img alt="" src="https://cdn.nlark.com/yuque/0/2020/png/1234840/1609075535716-8b5a54bd-d196-49bf-aad0-a34af55f4bad.png#crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;height=535&amp;id=Xkk9H&amp;originHeight=535&amp;originWidth=708&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=0&amp;status=done&amp;style=none&amp;title=&amp;width=708" />
<div class="highlight"><pre><span></span><code>boxplot(count ~ spray, data = InsectSprays,
        notch = TRUE, add = TRUE, col = &quot;blue&quot;)
</code></pre></div></p>
<p>notch为TRUE，在图中添加缺口，add = TRUE，添加箱线图到当前图。
<div class="highlight"><pre><span></span><code>boxplot(decrease ~ treatment, data = OrchardSprays, col = &quot;bisque&quot;,log = &quot;y&quot;)
</code></pre></div></p>
<p>log指定x轴和y轴是否以log值绘制。
<img alt="" src="https://cdn.nlark.com/yuque/0/2020/png/1234840/1609075535723-b388293f-796c-4b34-82f9-f4ee376e5e5a.png#crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;height=538&amp;id=o7PpY&amp;originHeight=538&amp;originWidth=707&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=0&amp;status=done&amp;style=none&amp;title=&amp;width=707" /></p>
<div class="highlight"><pre><span></span><code>boxplot(decrease ~ treatment, data = OrchardSprays, col = &quot;bisque&quot;,log = &quot;x&quot;, horizontal=TRUE)
</code></pre></div>
<p>horizontal指定横向还是纵向。
<div class="highlight"><pre><span></span><code>rb &lt;- boxplot(decrease ~ treatment, data = OrchardSprays, col = &quot;bisque&quot;)
title(&quot;Comparing boxplot()s and non-robust mean +/- SD&quot;)
mn.t &lt;- tapply(OrchardSprays$decrease, OrchardSprays$treatment, mean)
sd.t &lt;- tapply(OrchardSprays$decrease, OrchardSprays$treatment, sd)
xi &lt;- 0.3 + seq(rb$n)
points(xi, mn.t, col = &quot;orange&quot;, pch = 18)
arrows(xi, mn.t - sd.t, xi, mn.t + sd.t,
       code = 3, col = &quot;pink&quot;, angle = 75, length = .1)
</code></pre></div></p>
<p>title添加标题，points添加点，arrows添加箭头。
<div class="highlight"><pre><span></span><code>mat &lt;- cbind(Uni05 = (1:100)/21, Norm = rnorm(100),
             `5T` = rt(100, df = 5), Gam2 = rgamma(100, shape = 2))
boxplot(mat)
</code></pre></div></p>
<div class="highlight"><pre><span></span><code>&gt; head(mat)
          Uni05       Norm         5T      Gam2
[1,] 0.04761905 -0.8023008 -0.9392075 1.3200652
[2,] 0.09523810 -0.9918310 -0.7544264 1.7215554
[3,] 0.14285714  1.0443386  0.5406036 2.6018986
[4,] 0.19047619  0.7212886  1.2623940 4.4606805
[5,] 0.23809524  0.1094451 -0.1583871 0.3623623
[6,] 0.28571429 -0.7407029 -2.2104001 0.3264808
</code></pre></div>
<p><img alt="" src="https://cdn.nlark.com/yuque/0/2020/png/1234840/1609075535704-4ac62004-e701-45c0-bc70-bb285aed630c.png#crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;height=453&amp;id=QKfMy&amp;originHeight=453&amp;originWidth=651&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=0&amp;status=done&amp;style=none&amp;title=&amp;width=651" />
<div class="highlight"><pre><span></span><code>boxplot(len ~ dose, data = ToothGrowth,
        boxwex = 0.25, at = 1:3 - 0.2,
        subset = supp == &quot;VC&quot;, col = &quot;yellow&quot;,
        main = &quot;Guinea Pigs&#39; Tooth Growth&quot;,
        xlab = &quot;Vitamin C dose mg&quot;,
        ylab = &quot;tooth length&quot;,
        xlim = c(0.5, 3.5), ylim = c(0, 35), yaxs = &quot;i&quot;)
</code></pre></div></p>
<div class="highlight"><pre><span></span><code>&gt; head(ToothGrowth)
   len supp dose
1  4.2   VC  0.5
2 11.5   VC  0.5
3  7.3   VC  0.5
4  5.8   VC  0.5
5  6.4   VC  0.5
6 10.0   VC  0.5
</code></pre></div>
<p><img alt="" src="https://cdn.nlark.com/yuque/0/2020/png/1234840/1609075535751-b702aafb-3815-4b3d-ae23-cac59265e73f.png#crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;height=548&amp;id=iOKq2&amp;originHeight=548&amp;originWidth=661&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=0&amp;status=done&amp;style=none&amp;title=&amp;width=661" />
boxwex指定盒子的宽度，at是数值向量，给出框图应该绘制的位置，特别是当add = TRUE时;默认值为1:n，其中n是盒子的数量。
<div class="highlight"><pre><span></span><code>boxplot(len ~ dose, data = ToothGrowth, add = TRUE,
        boxwex = 0.25, at = 1:3 + 0.2,
        subset = supp == &quot;OJ&quot;, col = &quot;orange&quot;)
</code></pre></div></p>
<p>subset：一种可选向量，指定用于绘图的观测值子集。
<img alt="" src="https://cdn.nlark.com/yuque/0/2020/png/1234840/1609075535782-db8dec09-d9c7-4067-acf5-7143629815df.png#crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;height=546&amp;id=lXWdl&amp;originHeight=546&amp;originWidth=660&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=0&amp;status=done&amp;style=none&amp;title=&amp;width=660" />
<div class="highlight"><pre><span></span><code>legend(2, 9, c(&quot;Ascorbic acid&quot;, &quot;Orange juice&quot;),
       fill = c(&quot;yellow&quot;, &quot;orange&quot;))
</code></pre></div></p>
<p>legend添加图注。
<img alt="" src="https://cdn.nlark.com/yuque/0/2020/png/1234840/1609075535764-fbd405fe-9b23-48bb-a687-7225a921f563.png#crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;height=538&amp;id=cNxso&amp;originHeight=538&amp;originWidth=678&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=0&amp;status=done&amp;style=none&amp;title=&amp;width=678" />
<div class="highlight"><pre><span></span><code>boxplot(len ~ dose:supp, data = ToothGrowth,
        boxwex = 0.5, col = c(&quot;orange&quot;, &quot;yellow&quot;),
        main = &quot;Guinea Pigs&#39; Tooth Growth&quot;,
        xlab = &quot;Vitamin C dose mg&quot;, ylab = &quot;tooth length&quot;,
        sep = &quot;:&quot;, lex.order = TRUE, ylim = c(0, 35), yaxs = &quot;i&quot;)
</code></pre></div></p>
<p><img alt="" src="https://cdn.nlark.com/yuque/0/2020/png/1234840/1609075535744-912cb4ac-4980-40b3-b2d6-eea7fbd668ce.png#crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;height=545&amp;id=J2bxz&amp;originHeight=545&amp;originWidth=677&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=0&amp;status=done&amp;style=none&amp;title=&amp;width=677" />
其他参数：
na.action：一个函数，指示当数据包含NAs时应该发生什么。默认情况是忽略响应或组中缺失的值。
names：分组标签，将打印在每个箱线图下。可以是字符向量或表达式。
一张图中绘制几个图
<div class="highlight"><pre><span></span><code>require(stats)
set.seed(753)
(bx.p &lt;- boxplot(split(rt(100, 4), gl(5, 20))))
op &lt;- par(mfrow =  c(2, 2))
bxp(bx.p, xaxt = &quot;n&quot;)
bxp(bx.p, notch = TRUE, axes = FALSE, pch = 4, boxfill = 1:5)
bxp(bx.p, notch = TRUE, boxfill = &quot;lightblue&quot;, frame = FALSE,
    outl = FALSE, main = &quot;bxp(*, frame= FALSE, outl= FALSE)&quot;)
bxp(bx.p, notch = TRUE, boxfill = &quot;lightblue&quot;, border = 2:6,
    ylim = c(-4,4), pch = 22, bg = &quot;green&quot;, log = &quot;x&quot;,
    main = &quot;... log = &#39;x&#39;, ylim = *&quot;)
par(op)
op &lt;- par(mfrow = c(1, 2))
## single group -- no label
boxplot (weight ~ group, data = PlantGrowth, subset = group == &quot;ctrl&quot;)
## with label
bx &lt;- boxplot(weight ~ group, data = PlantGrowth,
              subset = group == &quot;ctrl&quot;, plot = FALSE)
bxp(bx, show.names=TRUE)
par(op)
</code></pre></div></p>
<p><img alt="" src="https://cdn.nlark.com/yuque/0/2020/png/1234840/1609075535710-13a536ef-efb9-4ef9-8cdf-30a587b3ac1f.png#crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;height=502&amp;id=e7l8F&amp;originHeight=502&amp;originWidth=672&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=0&amp;status=done&amp;style=none&amp;title=&amp;width=672" />
<img alt="" src="https://cdn.nlark.com/yuque/0/2020/png/1234840/1609075535772-bad6d769-34b3-4fb9-9a92-02dd9fb8ea6e.png#crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;height=523&amp;id=eGoz6&amp;originHeight=523&amp;originWidth=672&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=0&amp;status=done&amp;style=none&amp;title=&amp;width=672" /></p>
<h1 id="_4"><strong>六.热图绘制</strong><a class="headerlink" href="#_4" title="Permanent link">&para;</a></h1>
<p>数据20行，10列的数据如下：
<img alt="" src="https://cdn.nlark.com/yuque/0/2020/png/1234840/1609075535779-c3336357-c934-4e3e-b334-2194b47c80ae.png#crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;height=546&amp;id=xmRba&amp;originHeight=546&amp;originWidth=962&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=0&amp;status=done&amp;style=none&amp;title=&amp;width=962" /></p>
<div class="highlight"><pre><span></span><code>test = matrix(rnorm(200), 20, 10)
test[1:10, seq(1, 10, 2)] = test[1:10, seq(1, 10, 2)] + 3
test[11:20, seq(2, 10, 2)] = test[11:20, seq(2, 10, 2)] + 2
test[15:20, seq(2, 10, 2)] = test[15:20, seq(2, 10, 2)] + 4
colnames(test) = paste(&quot;Test&quot;, 1:10, sep = &quot;&quot;)
rownames(test) = paste(&quot;Gene&quot;, 1:20, sep = &quot;&quot;)
</code></pre></div>
<p>最简单粗暴的绘图
<div class="highlight"><pre><span></span><code>pheatmap(test)
</code></pre></div></p>
<p><img alt="" src="https://cdn.nlark.com/yuque/0/2020/png/1234840/1609075535798-5080d327-2074-42ac-b774-32389a6c557e.png#crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;height=670&amp;id=scNzz&amp;originHeight=670&amp;originWidth=734&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=0&amp;status=done&amp;style=none&amp;title=&amp;width=734" />
<div class="highlight"><pre><span></span><code>pheatmap(test, kmeans_k = 4)
</code></pre></div></p>
<p>kmeans_k参数按行指定聚类个数。
<img alt="" src="https://cdn.nlark.com/yuque/0/2020/png/1234840/1609075536054-9163b562-8f18-47f5-9375-bc1677d65dce.png#crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;height=596&amp;id=UIlew&amp;originHeight=671&amp;originWidth=802&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=0&amp;status=done&amp;style=none&amp;title=&amp;width=712" /></p>
<p>字符串，指示值应按行方向或列方向居中和缩放，或不按行方向缩放。对应的值是“row”、“column”和“none”
<div class="highlight"><pre><span></span><code>pheatmap(test, scale = &quot;row&quot;, clustering_distance_rows = &quot;correlation&quot;)
</code></pre></div></p>
<p><img alt="" src="https://cdn.nlark.com/yuque/0/2020/png/1234840/1609075535929-8bd0f541-f644-43a0-a88e-0fb581fa196e.png#crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;height=671&amp;id=uLEcH&amp;originHeight=671&amp;originWidth=803&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=0&amp;status=done&amp;style=none&amp;title=&amp;width=803" />
指定颜色：
<div class="highlight"><pre><span></span><code>pheatmap(test, color = colorRampPalette(c(&quot;navy&quot;, &quot;white&quot;, &quot;firebrick3&quot;))(50))
</code></pre></div></p>
<p><img alt="" src="https://cdn.nlark.com/yuque/0/2020/png/1234840/1609075535762-33e37def-01cf-4f74-b7f0-570b437bebf6.png#crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;height=672&amp;id=fwNMz&amp;originHeight=672&amp;originWidth=682&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=0&amp;status=done&amp;style=none&amp;title=&amp;width=682" />
cluster_row参数指定行是否聚类
<div class="highlight"><pre><span></span><code>pheatmap(test, cluster_row = FALSE)
</code></pre></div></p>
<p><img alt="" src="https://cdn.nlark.com/yuque/0/2020/png/1234840/1609075535840-a7add306-dd0a-49c3-a5e2-d6868a6e0a5e.png#crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;height=673&amp;id=TGQLl&amp;originHeight=673&amp;originWidth=678&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=0&amp;status=done&amp;style=none&amp;title=&amp;width=678" />
cluster_cols指定列是否聚类
<div class="highlight"><pre><span></span><code>pheatmap(test, cluster_cols = FALSE)
</code></pre></div></p>
<p><img alt="" src="https://cdn.nlark.com/yuque/0/2020/png/1234840/1609075535777-0114ad06-1da0-4198-9266-a232f7619185.png#crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;height=671&amp;id=qDssm&amp;originHeight=671&amp;originWidth=680&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=0&amp;status=done&amp;style=none&amp;title=&amp;width=680" />
legend指定是否显示图例
<div class="highlight"><pre><span></span><code>pheatmap(test, legend = FALSE)
</code></pre></div></p>
<p><img alt="" src="https://cdn.nlark.com/yuque/0/2020/png/1234840/1609075535753-e94246ed-14bf-4929-8a24-9bc866ef6f56.png#crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;height=671&amp;id=HY9i8&amp;originHeight=671&amp;originWidth=680&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=0&amp;status=done&amp;style=none&amp;title=&amp;width=680" />
display_numbers指定是否显示数值，fontsize_number指定字体大小。
<div class="highlight"><pre><span></span><code>pheatmap(test, display_numbers = TRUE)
</code></pre></div></p>
<p><img alt="" src="https://cdn.nlark.com/yuque/0/2020/png/1234840/1609075536101-1dff2ae7-aa96-4bcc-a5a7-5f48892bfd16.png#crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;height=675&amp;id=ffGZG&amp;originHeight=675&amp;originWidth=679&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=0&amp;status=done&amp;style=none&amp;title=&amp;width=679" />
number_format参数可以设置数值格式，比如保留几位小数。
<div class="highlight"><pre><span></span><code>pheatmap(test, display_numbers = TRUE, number_format = &quot;\%.1e&quot;)
</code></pre></div></p>
<p>也可以指定显示的什么，什么位置显示。
<div class="highlight"><pre><span></span><code>pheatmap(test, display_numbers = matrix(ifelse(test &gt; 5, &quot;*&quot;, &quot;&quot;), nrow(test)))
</code></pre></div></p>
<p><img alt="" src="https://cdn.nlark.com/yuque/0/2020/png/1234840/1609075535856-e19faba6-0e8c-4bc2-8eb5-4197c7379678.png#crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;height=669&amp;id=b3hKf&amp;originHeight=669&amp;originWidth=679&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=0&amp;status=done&amp;style=none&amp;title=&amp;width=679" />
legend_breaks 和legend_labels指定图例数值和标签
<div class="highlight"><pre><span></span><code>pheatmap(test, cluster_row = FALSE, legend_breaks = -1:4, 
         legend_labels = c(&quot;0&quot;,&quot;1e-4&quot;, &quot;1e-3&quot;, &quot;1e-2&quot;, &quot;1e-1&quot;, &quot;1&quot;))
</code></pre></div></p>
<p><img alt="" src="https://cdn.nlark.com/yuque/0/2020/png/1234840/1609075535815-a500220a-9f8e-47fa-9098-ee4433f2bc52.png#crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;height=671&amp;id=VI7Bq&amp;originHeight=671&amp;originWidth=682&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=0&amp;status=done&amp;style=none&amp;title=&amp;width=682" />
cellwidth和cellheight指定小方块的宽和高，main指定图的标题，fontsize指定字体大小。 
<div class="highlight"><pre><span></span><code>pheatmap(test, cellwidth = 15, cellheight = 12, main = &quot;Example heatmap&quot;)
</code></pre></div></p>
<p><img alt="" src="https://cdn.nlark.com/yuque/0/2020/png/1234840/1609075535801-5f25ab82-9f3e-4af3-95cc-06bd4ab27789.png#crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;height=619&amp;id=qf4GC&amp;originHeight=619&amp;originWidth=498&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=0&amp;status=done&amp;style=none&amp;title=&amp;width=498" />
为行和列生成注释，说白了就是分组信息
<div class="highlight"><pre><span></span><code>annotation_col = data.frame(
  CellType = factor(rep(c(&quot;CT1&quot;, &quot;CT2&quot;), 5)), 
  Time = 1:5
)
rownames(annotation_col) = paste(&quot;Test&quot;, 1:10, sep = &quot;&quot;)
</code></pre></div></p>
<p><img alt="" src="https://cdn.nlark.com/yuque/0/2020/png/1234840/1609075535795-39ca788a-bdff-45be-ba9b-d79394f62a49.png#crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;height=342&amp;id=zfzVM&amp;originHeight=342&amp;originWidth=240&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=0&amp;status=done&amp;style=none&amp;title=&amp;width=240" />
<div class="highlight"><pre><span></span><code>annotation_row = data.frame(
  GeneClass = factor(rep(c(&quot;Path1&quot;, &quot;Path2&quot;, &quot;Path3&quot;), c(10, 4, 6)))
)
rownames(annotation_row) = paste(&quot;Gene&quot;, 1:20, sep = &quot;&quot;)
</code></pre></div></p>
<p><img alt="" src="https://cdn.nlark.com/yuque/0/2020/png/1234840/1609075535841-5112243a-6950-47b0-b5e5-035ce23ce94a.png#crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;height=576&amp;id=yb4Ne&amp;originHeight=576&amp;originWidth=181&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=0&amp;status=done&amp;style=none&amp;title=&amp;width=181" />
这样就有列注释啦
<div class="highlight"><pre><span></span><code>pheatmap(test, annotation_col = annotation_col)
</code></pre></div></p>
<p><img alt="" src="https://cdn.nlark.com/yuque/0/2020/png/1234840/1609075535848-3ee6b00f-cfca-4ccd-9d68-de8074c8b397.png#crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;height=559&amp;id=GdM6m&amp;originHeight=559&amp;originWidth=672&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=0&amp;status=done&amp;style=none&amp;title=&amp;width=672" /></p>
<div class="highlight"><pre><span></span><code>pheatmap(test, annotation_col = annotation_col, annotation_row = annotation_row)
</code></pre></div>
<p><img alt="" src="https://cdn.nlark.com/yuque/0/2020/png/1234840/1609075535822-ee6f8e21-f5db-4bf8-8336-3dd84f16f25d.png#crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;height=565&amp;id=JZovl&amp;originHeight=565&amp;originWidth=675&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=0&amp;status=done&amp;style=none&amp;title=&amp;width=675" />
annotation_legend就用来指定注释信息
<div class="highlight"><pre><span></span><code>pheatmap(test, annotation_col = annotation_col, annotation_legend = FALSE)
</code></pre></div></p>
<p><img alt="" src="https://cdn.nlark.com/yuque/0/2020/png/1234840/1609075535996-49c30bf1-fa17-4424-ae7e-461e19b81aef.png#crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;height=559&amp;id=aspNF&amp;originHeight=559&amp;originWidth=671&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=0&amp;status=done&amp;style=none&amp;title=&amp;width=671" />
angle_col指定列标签角度。
<div class="highlight"><pre><span></span><code>pheatmap(test, annotation_col = annotation_col, annotation_row = annotation_row, angle_col = &quot;45&quot;)
</code></pre></div></p>
<p><img alt="" src="https://cdn.nlark.com/yuque/0/2020/png/1234840/1609075535813-087af17f-6034-4f1a-86d0-5312ee4054ef.png#crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;height=561&amp;id=R5RHo&amp;originHeight=561&amp;originWidth=678&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=0&amp;status=done&amp;style=none&amp;title=&amp;width=678" />
自定义注释颜色
<div class="highlight"><pre><span></span><code>ann_colors = list(
  Time = c(&quot;white&quot;, &quot;firebrick&quot;),
  CellType = c(CT1 = &quot;#1B9E77&quot;, CT2 = &quot;#D95F02&quot;),
  GeneClass = c(Path1 = &quot;#7570B3&quot;, Path2 = &quot;#E7298A&quot;, Path3 = &quot;#66A61E&quot;)
)
</code></pre></div></p>
<div class="highlight"><pre><span></span><code>pheatmap(test, annotation_col = annotation_col, annotation_row = annotation_row, 
         annotation_colors = ann_colors)
</code></pre></div>
<p><img alt="" src="https://cdn.nlark.com/yuque/0/2020/png/1234840/1609075535905-c49f0f34-828b-4132-b134-53d0ded0411e.png#crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;height=559&amp;id=ThbCh&amp;originHeight=559&amp;originWidth=676&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=0&amp;status=done&amp;style=none&amp;title=&amp;width=676" /></p>
<div class="highlight"><pre><span></span><code>pheatmap(test, annotation_col = annotation_col, annotation_colors = ann_colors[2])
</code></pre></div>
<p><img alt="" src="https://cdn.nlark.com/yuque/0/2020/png/1234840/1609075535822-e4c2cb36-7e58-4832-991b-41b72fcce87d.png#crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;height=562&amp;id=f0ptF&amp;originHeight=562&amp;originWidth=664&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=0&amp;status=done&amp;style=none&amp;title=&amp;width=664" /></p>
<p>gaps_row:向量的行指数，显示了在热图中把差距。仅在不聚类行时使用。</p>
<div class="highlight"><pre><span></span><code>pheatmap(test, annotation_col = annotation_col, cluster_rows = FALSE, gaps_row = c(10, 14))
</code></pre></div>
<p><img alt="" src="https://cdn.nlark.com/yuque/0/2020/png/1234840/1609075535823-05be52da-67c4-4b54-bff6-ec84c0dc5572.png#crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;height=560&amp;id=By518&amp;originHeight=560&amp;originWidth=680&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=0&amp;status=done&amp;style=none&amp;title=&amp;width=680" />
cutree_col和cutree_rows根据层次聚类(使用cutree)将行划分为多少个集群，如果没有对行进行聚类，则忽略参数。
<div class="highlight"><pre><span></span><code>pheatmap(test, annotation_col = annotation_col, cluster_rows = FALSE, gaps_row = c(10, 14), 
         cutree_col = 2)
</code></pre></div></p>
<p><img alt="" src="https://cdn.nlark.com/yuque/0/2020/png/1234840/1609075535848-75794b50-3e90-4cf6-a82b-88d7a9b31c09.png#crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;height=555&amp;id=XpnWD&amp;originHeight=555&amp;originWidth=668&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=0&amp;status=done&amp;style=none&amp;title=&amp;width=668" />
labels_row和labels_col重新定义行/列标签。
<div class="highlight"><pre><span></span><code>labels_row = c(&quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, 
               &quot;&quot;, &quot;&quot;, &quot;Il10&quot;, &quot;Il15&quot;, &quot;Il1b&quot;)
pheatmap(test, annotation_col = annotation_col, labels_row = labels_row)
</code></pre></div></p>
<p><img alt="" src="https://cdn.nlark.com/yuque/0/2020/png/1234840/1609075535843-b26bb54e-d763-4603-8a4a-71a4cc77ce63.png#crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;height=560&amp;id=d7Chs&amp;originHeight=560&amp;originWidth=676&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=0&amp;status=done&amp;style=none&amp;title=&amp;width=676" />
指定行列的聚类算法，默认皮尔森相关。这里的dist()函数计算并返回使用指定的距离度量来计算数据矩阵的行之间的距离所计算的距离矩阵。
<div class="highlight"><pre><span></span><code>drows = dist(test, method = &quot;minkowski&quot;)
dcols = dist(t(test), method = &quot;minkowski&quot;)
pheatmap(test, clustering_distance_rows = drows, clustering_distance_cols = dcols)
</code></pre></div></p>
<p><img alt="" src="https://cdn.nlark.com/yuque/0/2020/png/1234840/1609075535867-9f92032c-0518-404c-9808-7592e7eb35e5.png#crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;height=559&amp;id=M8ttV&amp;originHeight=559&amp;originWidth=678&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=0&amp;status=done&amp;style=none&amp;title=&amp;width=678" />
其他参数，自行探索啦，如：show_rownames，show_colnames是否显示行列名。
下面是使用ComplexHeatmap包绘图。
参考：<a href="https://mp.weixin.qq.com/s/jUTf1rfTZcXtxxU-KFW_ZQ">https://mp.weixin.qq.com/s/jUTf1rfTZcXtxxU-KFW_ZQ</a>
<div class="highlight"><pre><span></span><code><span class="nf">pdf</span><span class="p">(</span><span class="s">&quot;~/Downloads/hm.pdf&quot;</span><span class="p">)</span>

<span class="nf">set.seed</span><span class="p">(</span><span class="m">123</span><span class="p">)</span>
<span class="n">mat</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">matrix</span><span class="p">(</span>
<span class="w">  </span><span class="nf">rnorm</span><span class="p">(</span><span class="m">50</span><span class="o">*</span><span class="m">50</span><span class="p">),</span><span class="w"> </span>
<span class="w">  </span><span class="n">nrow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">50</span>
<span class="w">  </span><span class="p">)</span>

<span class="n">group</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span>
<span class="w">  </span><span class="s">&quot;MAPK&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="s">&quot;PI3K-Akt&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="s">&quot;ErbB&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="s">&quot;Cell cycle&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="s">&quot;Apoptosis&quot;</span>
<span class="p">)</span>

<span class="n">split</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">rep</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">5</span><span class="p">,</span><span class="w"> </span><span class="n">each</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">10</span><span class="p">)</span>

<span class="n">ha</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">HeatmapAnnotation</span><span class="p">(</span>
<span class="w">  </span><span class="n">empty</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">anno_empty</span><span class="p">(</span><span class="n">border</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">),</span>
<span class="w">  </span><span class="n">foo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">anno_block</span><span class="p">(</span>
<span class="w">    </span><span class="n">gp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">gpar</span><span class="p">(</span><span class="n">fill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="o">:</span><span class="m">6</span><span class="p">),</span><span class="w"> </span>
<span class="w">    </span><span class="n">labels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">group</span>
<span class="w">    </span><span class="p">)</span>
<span class="p">)</span>

<span class="nf">Heatmap</span><span class="p">(</span>
<span class="w">  </span><span class="n">mat</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;mat&quot;</span><span class="p">,</span><span class="w"> </span>
<span class="w">  </span><span class="n">column_split</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">split</span><span class="p">,</span><span class="w"> </span>
<span class="w">  </span><span class="n">top_annotation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ha</span><span class="p">,</span><span class="w"> </span>
<span class="w">  </span><span class="n">column_title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">NULL</span>
<span class="w">  </span><span class="p">)</span>

<span class="nf">library</span><span class="p">(</span><span class="n">glue</span><span class="p">)</span>
<span class="n">block_group_anno</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="kr">function</span><span class="p">(</span><span class="n">group</span><span class="p">,</span><span class="w"> </span><span class="n">empty_anno</span><span class="p">,</span><span class="w"> </span><span class="n">gp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">gpar</span><span class="p">(),</span>
<span class="w">                             </span><span class="n">label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">NULL</span><span class="p">,</span><span class="w"> </span><span class="n">label_gp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">gpar</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1"># 获取最左侧 viewport</span>
<span class="w">  </span><span class="nf">seekViewport</span><span class="p">(</span><span class="nf">glue</span><span class="p">(</span>
<span class="w">    </span><span class="s">&#39;annotation_{anno}_{slice}&#39;</span><span class="p">,</span><span class="w"> </span>
<span class="w">    </span><span class="n">slice</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">min</span><span class="p">(</span><span class="n">group</span><span class="p">),</span>
<span class="w">    </span><span class="n">anno</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">empty_anno</span><span class="p">)</span>
<span class="w">    </span><span class="p">)</span>
<span class="w">  </span><span class="c1"># 获取左下角坐标点</span>
<span class="w">  </span><span class="n">loc1</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">deviceLoc</span><span class="p">(</span>
<span class="w">    </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">unit</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;npc&quot;</span><span class="p">),</span><span class="w"> </span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">unit</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;npc&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="p">)</span>
<span class="w">  </span><span class="c1"># 获取最右侧 viewport</span>
<span class="w">  </span><span class="nf">seekViewport</span><span class="p">(</span><span class="nf">glue</span><span class="p">(</span>
<span class="w">    </span><span class="s">&#39;annotation_{anno}_{slice}&#39;</span><span class="p">,</span><span class="w"> </span>
<span class="w">    </span><span class="n">slice</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">max</span><span class="p">(</span><span class="n">group</span><span class="p">),</span>
<span class="w">    </span><span class="n">anno</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">empty_anno</span><span class="p">)</span>
<span class="w">  </span><span class="p">)</span>
<span class="w">  </span><span class="c1"># 获取右上角坐标点</span>
<span class="w">  </span><span class="n">loc2</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">deviceLoc</span><span class="p">(</span>
<span class="w">    </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">unit</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;npc&quot;</span><span class="p">),</span><span class="w"> </span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">unit</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;npc&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="p">)</span>
<span class="w">  </span><span class="c1"># 切换到全局 viewport</span>
<span class="w">  </span><span class="nf">seekViewport</span><span class="p">(</span><span class="s">&quot;global&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="c1"># 绘制矩形</span>
<span class="w">  </span><span class="nf">grid.rect</span><span class="p">(</span>
<span class="w">    </span><span class="n">loc1</span><span class="o">$</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">loc1</span><span class="o">$</span><span class="n">y</span><span class="p">,</span>
<span class="w">    </span><span class="n">width</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">loc2</span><span class="o">$</span><span class="n">x</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">loc1</span><span class="o">$</span><span class="n">x</span><span class="p">,</span><span class="w"> </span>
<span class="w">    </span><span class="n">height</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">loc2</span><span class="o">$</span><span class="n">y</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">loc1</span><span class="o">$</span><span class="n">y</span><span class="p">,</span><span class="w"> </span>
<span class="w">    </span><span class="n">just</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;left&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;bottom&quot;</span><span class="p">),</span><span class="w"> </span>
<span class="w">    </span><span class="n">gp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gp</span>
<span class="w">  </span><span class="p">)</span>
<span class="w">  </span><span class="c1"># 如果传递了标签，则添加标签</span>
<span class="w">  </span><span class="kr">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nf">is.null</span><span class="p">(</span><span class="n">label</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nf">grid.text</span><span class="p">(</span>
<span class="w">      </span><span class="n">label</span><span class="p">,</span><span class="w"> </span>
<span class="w">      </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">loc1</span><span class="o">$</span><span class="n">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">loc2</span><span class="o">$</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="m">0.5</span><span class="p">,</span><span class="w"> </span>
<span class="w">      </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">loc1</span><span class="o">$</span><span class="n">y</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">loc2</span><span class="o">$</span><span class="n">y</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="m">0.5</span><span class="p">,</span>
<span class="w">      </span><span class="n">gp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">label_gp</span>
<span class="w">    </span><span class="p">)</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
<span class="c1"># 将前三个热图块作为一组</span>
<span class="nf">block_group_anno</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">3</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;empty&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">gp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">gpar</span><span class="p">(</span><span class="n">fill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;red&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Signal transduction&quot;</span><span class="p">)</span>
<span class="c1"># 后两个作为一组</span>
<span class="nf">block_group_anno</span><span class="p">(</span><span class="m">4</span><span class="o">:</span><span class="m">5</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;empty&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">gp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">gpar</span><span class="p">(</span><span class="n">fill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;green&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Cellular Processes&quot;</span><span class="p">)</span>

<span class="nf">dev.off</span><span class="p">()</span>
</code></pre></div></p>
<h1 id="_5"><strong>七.生存曲线</strong><a class="headerlink" href="#_5" title="Permanent link">&para;</a></h1>
<div class="highlight"><pre><span></span><code>require(&quot;survival&quot;)
fit&lt;- survfit(Surv(time, status) ~ sex, data = lung)
# Basic survival curves
ggsurvplot(fit, data = lung)
</code></pre></div>
<p><img alt="" src="https://cdn.nlark.com/yuque/0/2020/png/1234840/1609075535897-b1c9101c-6295-4917-8696-83c919caf51e.png#crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;height=651&amp;id=BbaSM&amp;originHeight=651&amp;originWidth=694&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=0&amp;status=done&amp;style=none&amp;title=&amp;width=694" /></p>
<div class="highlight"><pre><span></span><code>ggsurvplot(fit, data = lung,
           # 用于在中位生存值绘制水平/垂直线的字符向量。允许的值包括
           # c(&quot;none&quot;, &quot;hv&quot;, &quot;h&quot;, &quot;v&quot;). v: vertical, h:horizontal.中的一个
           surv.median.line = &quot;hv&quot;, # Add medians survival

           # 修改标题和标签
           legend.title = &quot;Sex&quot;,
           legend.labs = c(&quot;Male&quot;, &quot;Female&quot;),
           # Add p-value and tervals
           pval = TRUE,

           conf.int = TRUE,#如果为真，则绘制置信区间。
           # Add risk table
           risk.table = TRUE,#指定是否显示风险表的TRUE或FALSE。默认是假的。
           tables.height = 0.2,
           tables.theme = theme_cleantable(),

           # Color palettes. Use custom color: c(&quot;#E7B800&quot;, &quot;#2E9FDF&quot;),
           # or brewer color (e.g.: &quot;Dark2&quot;), or ggsci color (e.g.: &quot;jco&quot;)
           palette = c(&quot;#E7B800&quot;, &quot;#2E9FDF&quot;),
           ggtheme = theme_bw() # Change ggplot2 theme
)
</code></pre></div>
<p><img alt="" src="https://cdn.nlark.com/yuque/0/2020/png/1234840/1609075535829-fd71c0f4-79e5-4c25-bcc7-fb794399278f.png#crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;height=655&amp;id=N21aL&amp;originHeight=655&amp;originWidth=688&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=0&amp;status=done&amp;style=none&amp;title=&amp;width=688" />
改变字体大小，风格和颜色
<div class="highlight"><pre><span></span><code>ggsurvplot(fit, data = lung,  main = &quot;Survival curve&quot;,
           font.main = c(16, &quot;bold&quot;, &quot;darkblue&quot;),
           font.x = c(14, &quot;bold.italic&quot;, &quot;red&quot;),
           font.y = c(14, &quot;bold.italic&quot;, &quot;darkred&quot;),
           font.tickslab = c(12, &quot;plain&quot;, &quot;darkgreen&quot;))
</code></pre></div></p>
<p><img alt="" src="https://cdn.nlark.com/yuque/0/2020/png/1234840/1609075535918-389a2509-d3ce-4697-b7f5-1fef88d9213d.png#crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;height=651&amp;id=xwToG&amp;originHeight=651&amp;originWidth=690&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=0&amp;status=done&amp;style=none&amp;title=&amp;width=690" /></p>
<h1 id="_6"><strong>八.火山图</strong><a class="headerlink" href="#_6" title="Permanent link">&para;</a></h1>
<div class="highlight"><pre><span></span><code>colr &lt;- brewer.pal(9,&quot;Set1&quot;)[c(3,9,1)]
ggplot(data = diff, aes(x = logFC, y = logP, color = Group)) +  
  geom_point(alpha=0.8, size = 2) +  
  theme_bw(base_size = 15) +  
  theme(panel.grid.minor = element_blank(),
        panel.grid.major = element_blank()) +  
  scale_color_manual(values=colr)+
  scale_fill_manual(values =colr)+ 
  labs(x=&quot;log(Fold change)&quot;,y=&quot;-log(P value)&quot;)+
  theme(legend.title = element_blank(),
        legend.text = element_text(size = 8, face = &quot;bold&quot;),
        legend.margin = margin(t = 0, r = 0, b = 0, l = 0, unit = &quot;pt&quot;),
        legend.direction = &quot;horizontal&quot;,
        legend.position = c(0.5,0.96),
        legend.background = element_blank(),
        panel.background = element_rect(fill = &quot;transparent&quot;,colour = &quot;black&quot;),
        plot.background = element_blank())
</code></pre></div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  回到页面顶部
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2022 - 2025 DoubleHelix
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        
<div class="md-social">
  
    
    
    
    
    <a href="https://space.bilibili.com/434318322" target="_blank" rel="noopener" title="Bilibili | BioInfoCloud" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M488.6 104.1c16.7 18.1 24.4 39.7 23.3 65.7v202.4c-.4 26.4-9.2 48.1-26.5 65.1-17.2 17-39.1 25.9-65.5 26.7H92c-26.4-.8-48.2-9.8-65.3-27.2S.7 396.5 0 368.2V169.8c.8-26 9.7-47.6 26.7-65.7C43.8 87.8 65.5 78.8 92 78h29.4L96 52.2c-5.7-5.7-8.6-13-8.6-21.8S90.3 14.3 96 8.6 109 0 117.9 0s16.1 2.9 21.9 8.6L213.1 78h88l74.5-69.4C381.7 2.9 389.2 0 398 0s16.1 2.9 21.9 8.6c5.7 5.7 8.6 13 8.6 21.8s-2.9 16.1-8.6 21.8L394.6 78h29.3c26.4.8 48 9.8 64.7 26.1m-38.8 69.7c-.4-9.6-3.7-17.4-10.7-23.5-5.2-6.1-14-9.4-22.7-9.8H96c-9.6.4-17.4 3.7-23.6 9.8-6.1 6.1-9.4 13.9-9.8 23.5v194.4c0 9.2 3.3 17 9.8 23.5s14.4 9.8 23.6 9.8h320.4c9.2 0 17-3.3 23.3-9.8s9.7-14.3 10.1-23.5zm-264.3 42.7c6.3 6.3 9.7 14.1 10.1 23.2V273c-.4 9.2-3.7 16.9-9.8 23.2-6.2 6.3-14 9.5-23.6 9.5s-17.5-3.2-23.6-9.5-9.4-14-9.8-23.2v-33.3c.4-9.1 3.8-16.9 10.1-23.2s13.2-9.6 23.3-10c9.2.4 17 3.7 23.3 10m191.5 0c6.3 6.3 9.7 14.1 10.1 23.2V273c-.4 9.2-3.7 16.9-9.8 23.2s-14 9.5-23.6 9.5-17.4-3.2-23.6-9.5c-7-6.3-9.4-14-9.7-23.2v-33.3c.3-9.1 3.7-16.9 10-23.2s14.1-9.6 23.3-10c9.2.4 17 3.7 23.3 10"/></svg>
    </a>
  
    
    
    
    
    <a href="https://github.com/BioInfoCloud" target="_blank" rel="noopener" title="GitHub | BioInfoCloud" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.tabs", "navigation.top", "navigation.indexes", "navigation.expand", "search.suggest", "search.highlight"], "search": "../../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "\u5df2\u590d\u5236", "clipboard.copy": "\u590d\u5236", "search.result.more.one": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.other": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 # \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.term.missing": "\u7f3a\u5c11", "select.version": "\u9009\u62e9\u5f53\u524d\u7248\u672c"}, "version": null}</script>
    
    
      <script src="../../../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
        <script src="../../../mkdocs/javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>